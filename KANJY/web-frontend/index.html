<!DOCTYPE html>
<html lang="ja" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KANJY - ç¾ã—ã„è¡¨ãƒ‡ã‚¶ã‚¤ãƒ³</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- ã‚«ã‚¹ã‚¿ãƒ ã‚¹ã‚¿ã‚¤ãƒ« -->
    <style>
        /* åŸºæœ¬çš„ãªãƒªã‚»ãƒƒãƒˆ */
        * {
            box-sizing: border-box;
        }
        
        /* æ¨ªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«åˆ¶å¾¡ */
        body, html {
            overflow-x: hidden;
            max-width: 100vw;
        }
        
        /* ãƒ†ãƒ¼ãƒ–ãƒ«ã‚³ãƒ³ãƒ†ãƒŠã¯æ¨ªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«è¨±å¯ */
        .overflow-x-auto {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        
        /* ãƒ†ãƒ¼ãƒ–ãƒ«è¡Œã®ãƒ›ãƒãƒ¼åŠ¹æœ */
        tbody tr:hover,
        .table-row:hover,
        tr:hover {
            background: rgba(248,250,252,0.7) !important;
            transform: translateX(2px) !important;
        }
        
        /* Notioné¢¨ã‚¿ã‚¤ãƒã‚°ãƒ©ãƒ•ã‚£ãƒ¼ã‚·ã‚¹ãƒ†ãƒ  */
        .notion-heading-1 {
            font-size: 2.5rem;
            line-height: 1.2;
            font-weight: 700;
            letter-spacing: -0.02em;
            color: #111827;
        }
        
        .notion-heading-2 {
            font-size: 2rem;
            line-height: 1.3;
            font-weight: 600;
            letter-spacing: -0.01em;
            color: #111827;
        }
        
        .notion-heading-3 {
            font-size: 1.5rem;
            line-height: 1.4;
            font-weight: 600;
            letter-spacing: -0.005em;
            color: #111827;
        }
        
        .notion-heading-4 {
            font-size: 1.25rem;
            line-height: 1.5;
            font-weight: 600;
            color: #374151;
        }
        
        .notion-body {
            font-size: 1rem;
            line-height: 1.6;
            font-weight: 400;
            color: #4B5563;
        }
        
        .notion-body-medium {
            font-size: 1rem;
            line-height: 1.6;
            font-weight: 500;
            color: #374151;
        }
        
        .notion-caption {
            font-size: 0.875rem;
            line-height: 1.5;
            font-weight: 400;
            color: #6B7280;
        }
        
        .notion-small {
            font-size: 0.75rem;
            line-height: 1.4;
            font-weight: 500;
            color: #9CA3AF;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .notion-mono {
            font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
            font-size: 0.875rem;
            line-height: 1.6;
            font-weight: 400;
            color: #374151;
        }
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- Supabase CDN -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'sans': ['Inter', 'system-ui', '-apple-system', 'sans-serif'],
                    },
                    colors: {
                        kanjy: {
                            50: '#f9fafb',
                            100: '#f3f4f6',
                            200: '#e5e7eb',
                            300: '#d1d5db',
                            400: '#9ca3af',
                            500: '#000000',
                            600: '#374151',
                            700: '#1f2937',
                            800: '#111827',
                            900: '#030712',
                        },
                        // SwiftUIã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆï¼ˆæ´—ç·´ç‰ˆï¼‰
                        attending: {
                            50: '#ecfdf5',
                            100: '#d1fae5',
                            500: '#10b981', // ç¾ã—ã„ç·‘
                            600: '#059669',
                            700: '#047857',
                        },
                        maybe: {
                            50: '#fff7ed',
                            100: '#ffedd5',
                            500: '#f97316', // é®®ã‚„ã‹ãªã‚ªãƒ¬ãƒ³ã‚¸
                            600: '#ea580c',
                            700: '#c2410c',
                        },
                        notAttending: {
                            50: '#fef2f2',
                            100: '#fee2e2',
                            500: '#ef4444', // æ´—ç·´ã•ã‚ŒãŸèµ¤
                            600: '#dc2626',
                            700: '#b91c1c',
                        },
                        undecided: {
                            50: '#f9fafb',
                            100: '#f3f4f6',
                            500: '#6b7280', // ä¸Šå“ãªã‚°ãƒ¬ãƒ¼
                            600: '#4b5563',
                            700: '#374151',
                        }
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-in-out',
                        'slide-up': 'slideUp 0.6s ease-out',
                        'scale-in': 'scaleIn 0.3s ease-out',
                        'float': 'float 3s ease-in-out infinite',
                        'shimmer': 'shimmer 2s linear infinite',
                        'bounce-gentle': 'bounceGentle 2s infinite',
                        'pulse-soft': 'pulseSoft 2s infinite',
                        'slide-in-right': 'slideInRight 0.3s ease-out',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' },
                        },
                        scaleIn: {
                            '0%': { transform: 'scale(0.95)', opacity: '0' },
                            '100%': { transform: 'scale(1)', opacity: '1' },
                        },
                        float: {
                            '0%, 100%': { transform: 'translateY(0px)' },
                            '50%': { transform: 'translateY(-10px)' },
                        },
                        shimmer: {
                            '0%': { transform: 'translateX(-100%)' },
                            '100%': { transform: 'translateX(100%)' },
                        },
                        bounceGentle: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-5px)' },
                        },
                        pulseSoft: {
                            '0%, 100%': { opacity: '1' },
                            '50%': { opacity: '0.8' },
                        },
                        slideInRight: {
                            '0%': { transform: 'translateX(100%)', opacity: '0' },
                            '100%': { transform: 'translateX(0)', opacity: '1' },
                        }
                    },
                    backdropBlur: {
                        '3xl': '64px',
                    },
                    boxShadow: {
                        'glass': '0 8px 32px 0 rgba(31, 38, 135, 0.37)',
                        'elegant': '0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)',
                        'soft': '0 2px 15px 0 rgba(0, 0, 0, 0.1)',
                        'floating': '0 25px 50px -12px rgba(0, 0, 0, 0.25)',
                    }
                }
            }
        }
    </script>
    
    <style>
        /* CSSå¤‰æ•° */
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #f1f5f9;
            --text-primary: #1e293b;
            --text-secondary: #475569;
            --text-tertiary: #64748b;
            --border-primary: #e2e8f0;
            --border-secondary: #cbd5e1;
            --shadow-color: rgba(0, 0, 0, 0.1);
            --glass-bg: rgba(255, 255, 255, 0.25);
            --glass-border: rgba(255, 255, 255, 0.18);
            --card-background: #ffffff;
            --card-border: #E9E5E0;
            --card-shadow-soft: 0 1px 3px rgba(15, 23, 42, 0.08);
            --card-shadow-hover: 0 12px 35px rgba(15, 23, 42, 0.14);
            --card-shadow-strong: 0 20px 45px rgba(15, 23, 42, 0.2);
            --section-divider: #E9E5E0;
        }
        
        @keyframes gradient-shift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        .gradient-animated {
            background: #ffffff;
        }
        
        .glassmorphism {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
        }
        
        .table-hover-row:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px var(--shadow-color);
        }
        
        .status-pill {
            position: relative;
            overflow: hidden;
        }
        
        .status-pill::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .status-pill:hover::before {
            left: 100%;
        }
        
        .floating-element {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .floating-element:hover {
            transform: translateY(-4px) scale(1.02);
            box-shadow: 0 20px 40px var(--shadow-color);
        }
        
        .smooth-reveal {
            animation: fadeIn 0.8s ease-out;
        }
        
        /* ã‚«ã‚¹ã‚¿ãƒ ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #007AFF, #5856D6);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #0056cc, #4c46a6);
        }
        
        /* é«˜åº¦ãªãƒã‚¤ã‚¯ãƒ­ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ */
        .micro-transition {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        /* ãƒœã‚¿ãƒ³ãƒ›ãƒãƒ¼åŠ¹æœã®å¼·åŒ– */
        .interactive-element {
            position: relative;
            overflow: hidden;
            transform: translateZ(0);
            will-change: transform, box-shadow;
        }
        
        .interactive-element::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .interactive-element:hover::before {
            left: 100%;
        }
        
        .interactive-element:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }
        
        .interactive-element:active {
            transform: translateY(0) scale(0.98);
            transition: transform 0.1s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .notion-section {
            background: var(--card-background);
            border-top: 1px solid var(--section-divider);
            border-bottom: 1px solid var(--section-divider);
        }

        .card-divider {
            border-bottom: 1px solid var(--section-divider);
        }

        .enhanced-card {
            background: var(--card-background);
            border: 1px solid var(--card-border);
            border-radius: 1rem;
            box-shadow: var(--card-shadow-soft);
        }

        .card-hover {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card-hover:hover {
            box-shadow: var(--card-shadow-hover);
            transform: translateY(-4px);
        }

        .notion-table {
            border-collapse: separate;
            border-spacing: 0;
        }

        .notion-table thead th {
            background: #F7F6F3;
        }

        .notion-table thead tr {
            border-bottom: 1px solid var(--section-divider);
        }

        .notion-table thead th + th,
        .notion-table tbody td + td {
            border-left: 1px solid var(--section-divider);
        }

        .notion-table thead th:first-child,
        .notion-table tbody td:first-child {
            border-left: none;
        }

        .stat-icon--attending {
            color: #0F7B0F;
        }

        .stat-icon--maybe {
            color: #D97706;
        }

        .stat-icon--decline {
            color: #6B7280;
        }

        /* ãƒ†ãƒ¼ãƒ–ãƒ«è¡Œã®ãƒ›ãƒãƒ¼åŠ¹æœå¼·åŒ– */
        .table-row {
            position: relative;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .table-row:hover {
            background: rgba(248,250,252,0.7) !important;
            transform: translateX(2px) !important;
            border: none !important;
            box-shadow: none !important;
        }
        
        /* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒƒã‚¸ã®æ”¹å–„ */
        .status-badge {
            position: relative;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(10px);
        }
        
        .status-badge:hover {
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        }
        
        /* ãƒ‘ãƒ«ã‚¹åŠ¹æœ */
        .pulse-effect {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
                transform: scale(1);
            }
            50% {
                opacity: 0.8;
                transform: scale(1.05);
            }
        }
        
        /* ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°åŠ¹æœã®æ”¹å–„ */
        .loading-shimmer {
            position: relative;
            overflow: hidden;
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }
        
        @keyframes shimmer {
            0% {
                background-position: -200% 0;
            }
            100% {
                background-position: 200% 0;
            }
        }
        
        /* ã‚«ãƒ¼ãƒ‰ã®æ”¹å–„ã•ã‚ŒãŸãƒ›ãƒãƒ¼åŠ¹æœ */
        .enhanced-card {
            position: relative;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            background: var(--card-background);
            border: 1px solid var(--card-border);
            border-radius: 1rem;
            box-shadow: var(--card-shadow-soft);
        }
        
        /* ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«æ™‚ã®è¦ç´ è¡¨ç¤ºã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
        .fade-in-up {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .fade-in-up.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* ãƒ¢ãƒã‚¤ãƒ«æœ€é©åŒ– */
        @media (max-width: 768px) {
            /* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã®æ”¹å–„ */
            .max-w-7xl, .max-w-4xl {
                padding-left: 1rem;
                padding-right: 1rem;
            }
            
            /* ãƒ˜ãƒƒãƒ€ãƒ¼ã®é«˜ã•ã‚’èª¿æ•´ */
            nav .h-20 {
                height: auto;
                min-height: 60px;
                padding: 0.75rem 0;
            }
            
            /* App Storeãƒœã‚¿ãƒ³ã‚’ã‚¢ã‚¤ã‚³ãƒ³ã®ã¿ã« */
            nav a span {
                display: none;
            }
            
            nav a {
                padding: 0.5rem !important;
                min-width: 40px;
                justify-content: center;
            }
            
            nav a svg {
                margin: 0;
            }
            
            /* ã‚¿ã‚¤ãƒˆãƒ«ã®ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºèª¿æ•´ */
            .notion-heading-1 {
                font-size: 1.875rem;
                line-height: 1.2;
            }
            
            .notion-heading-2 {
                font-size: 1.5rem;
                line-height: 1.3;
            }
            
            .notion-heading-4 {
                font-size: 1.125rem;
                line-height: 1.4;
            }
            
            /* ã‚°ãƒ©ãƒ•/è¡¨åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ã®æœ€é©åŒ– */
            #chart-view-btn span,
            #table-view-btn span {
                display: none;
            }
            
            #chart-view-btn,
            #table-view-btn {
                padding: 0.5rem !important;
                min-width: 40px;
            }
            
            /* ã‚°ãƒ©ãƒ•è¡¨ç¤ºã‚¨ãƒªã‚¢ã®é«˜ã•èª¿æ•´ */
            #schedule-chart {
                height: 300px !important;
            }
            
            /* ã‚¿ãƒƒãƒãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªãƒœã‚¿ãƒ³ */
            .interactive-element {
                min-height: 44px;
                padding: 0.75rem 1rem;
            }
            
            /* ãƒ†ãƒ¼ãƒ–ãƒ«ã®æ”¹å–„ */
            .table-row:hover {
                transform: none;
                background: rgba(248,250,252,0.7);
            }
            
            /* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒƒã‚¸ã®ã‚¿ãƒƒãƒå¯¾å¿œ */
            .status-badge {
                min-width: 44px;
                min-height: 44px;
                padding: 0.5rem;
            }
            
            .status-badge:hover {
                transform: scale(1.05);
                rotate: 0deg;
            }
            
            /* ã‚«ãƒ¼ãƒ‰ã®ãƒ¢ãƒã‚¤ãƒ«è¡¨ç¤º */
            .enhanced-card {
                margin: 0.5rem 0;
                border-radius: 1rem;
            }

            .card-hover:hover {
                transform: translateY(-2px) scale(1.005);
            }
            
            /* ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã®èª¿æ•´ */
            .text-3xl {
                font-size: 1.875rem;
            }
            
            .text-2xl {
                font-size: 1.5rem;
            }
            
            /* ã‚¹ãƒšãƒ¼ã‚·ãƒ³ã‚°ã®èª¿æ•´ */
            .px-8 {
                padding-left: 1rem;
                padding-right: 1rem;
            }
            
            .py-6 {
                padding-top: 1rem;
                padding-bottom: 1rem;
            }
            
            /* ãƒ†ãƒ¼ãƒ–ãƒ«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã®æ”¹å–„ */
            .overflow-x-auto {
                overflow-x: auto !important;
                -webkit-overflow-scrolling: touch;
                scrollbar-width: thin;
            }
            
            .overflow-x-auto::-webkit-scrollbar {
                height: 4px;
            }
            
            .overflow-x-auto::-webkit-scrollbar-thumb {
                background: rgba(0, 0, 0, 0.2);
                border-radius: 2px;
            }
            
            /* ãƒ†ãƒ¼ãƒ–ãƒ«ã®æœ€å°å¹…è¨­å®š */
            .notion-table {
                min-width: 600px;
            }
            
            /* ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ä½™ç™½èª¿æ•´ */
            .notion-section {
                padding-top: 1rem;
                padding-bottom: 1rem;
            }
            
            /* ãƒœã‚¿ãƒ³ã‚°ãƒ«ãƒ¼ãƒ—ã®ã‚¹ãƒšãƒ¼ã‚¹èª¿æ•´ */
            button + button {
                margin-left: 0.5rem;
            }
        }
        
        /* ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆå¯¾å¿œ */
        @media (min-width: 769px) and (max-width: 1024px) {
            .card-hover:hover {
                transform: translateY(-6px) scale(1.008);
            }
            
            .table-row:hover {
                transform: translateX(2px);
            }
        }
        
        /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œ */
        @media (prefers-color-scheme: dark) {
            :root {
                --bg-primary: #1a1a1a;
                --bg-secondary: #2d2d2d;
                --text-primary: #ffffff;
                --text-secondary: #b0b0b0;
                --border-primary: #404040;
            }
            
            .bg-white {
                background-color: var(--bg-secondary);
                color: var(--text-primary);
            }
            
            .text-gray-900 {
                color: var(--text-primary);
            }
            
            .text-stone-600 {
                color: var(--text-secondary);
            }
            
            .border-stone-200\/60 {
                border-color: var(--border-primary);
            }
        }
        
        /* é«˜è§£åƒåº¦ãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤å¯¾å¿œ */
        @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
            .enhanced-card {
                border-width: 0.5px;
            }
            
            .status-badge {
                border-width: 0.5px;
            }
        }
        
        /* ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£æ”¹å–„ */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
            
            .fade-in-up {
                opacity: 1;
                transform: none;
            }
        }
        
        /* ãƒ•ã‚©ãƒ¼ã‚«ã‚¹è¡¨ç¤ºã®æ”¹å–„ */
        .interactive-element:focus {
            outline: 2px solid #007AFF;
            outline-offset: 2px;
        }
        
        .status-badge:focus {
            outline: 2px solid #007AFF;
            outline-offset: 2px;
        }
        
        /* ãƒ—ãƒªãƒ³ãƒˆå¯¾å¿œ */
        @media print {
            .interactive-element,
            .status-badge {
                box-shadow: none;
                transform: none;
            }
            
            .enhanced-card {
                box-shadow: none;
                border: 1px solid #ccc;
            }
        }
        
        /* ãƒ†ãƒ¼ãƒ–ãƒ«ã®å¢ƒç•Œç·šãƒªã‚»ãƒƒãƒˆ */
        .schedule-table table,
        .schedule-table th,
        .schedule-table td,
        .responses-table table,
        .responses-table th,
        .responses-table td {
            border: none;
            outline: none;
        }
        
        .schedule-table thead tr,
        .responses-table thead tr {
            border-bottom: 1px solid #E9E5E0;
        }

        .schedule-table tbody tr:hover,
        .responses-table tbody tr:hover {
            border: none;
        }

        /* ã‚«ãƒ¼ãƒ‰ã®ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ */
        .enhanced-card {
            border: 1px solid rgba(0, 0, 0, 0.08);
            border-radius: 0.75rem;
        }

        nav {
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }

        /* å›ç­”CTAã®å¼·èª¿ */
        .response-cta {
            background: linear-gradient(135deg, #1f2937, #0f172a);
            color: #f8fafc;
            box-shadow: var(--card-shadow-strong);
        }

        .response-cta:hover,
        .response-cta:focus-within {
            background: linear-gradient(135deg, #1f2937, #0f172a);
            color: #f8fafc;
        }

        .response-cta .notion-heading-4,
        .response-cta .notion-body {
            color: inherit;
        }

        .response-cta .accent-bar {
            background: linear-gradient(180deg, rgba(255,255,255,0.35), rgba(148, 163, 184, 0.4));
        }

        .response-cta button {
            background: #f8fafc;
            color: #0f172a;
        }

        .response-cta button:hover {
            background: #e2e8f0;
        }
    </style>
</head>

<body class="font-sans antialiased text-gray-900 min-h-screen bg-stone-50">
    
    <!-- Hero Section with Glass Effect -->
    <header class="relative">
        <!-- Ultra Minimal Navigation -->
        <nav class="bg-white shadow-sm backdrop-blur-xl">
            <div class="max-w-4xl mx-auto px-6 sm:px-8 lg:px-12">
                <div class="flex justify-between items-center h-20">
                    <div class="flex items-center">
                        <span class="text-gray-900 font-light text-xl tracking-[0.2em] uppercase">K A N J Y</span>
                    </div>
                    <div class="flex items-center">
                        <a href="https://apps.apple.com/jp/app/kanjy/id6746665673" target="_blank" 
                           class="inline-flex items-center space-x-2 bg-gray-100 hover:bg-gray-200 transition-colors duration-200 px-4 py-2 rounded-lg text-sm font-medium text-gray-700">
                            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z"/>
                            </svg>
                            <span>App Storeã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</span>
                        </a>
                    </div>
                </div>
            </div>
        </nav>

    </header>

    <!-- Main Content -->
    <main class="pb-24">
        <!-- Event Info Block - Full Width -->
        <section class="notion-section py-8">
            <div class="max-w-4xl mx-auto px-6 sm:px-8 lg:px-12">
                <!-- Event Title & Description -->
                <div class="mb-8">
                    <h1 id="event-title" class="notion-heading-2 mb-3">
                        èª­ã¿è¾¼ã¿ä¸­...
                    </h1>
                    <div id="loading-status" style="color: #666; font-size: 14px; margin-top: 8px;">
                        ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: åˆæœŸåŒ–ä¸­...
                    </div>
                    <div id="error-display" style="display: none; color: #ef4444; font-size: 14px; margin-top: 8px; padding: 12px; background: #fee; border-radius: 8px; white-space: pre-wrap;">
                    </div>
                    <p id="event-description" class="notion-body" style="display: none;">
                    </p>
                </div>

                <!-- Event Details -->
                <div id="event-info-cards" class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
                    <!-- Location Card -->
                    <div id="location-section" style="display: none;">
                        <h3 class="notion-small mb-3">å ´æ‰€</h3>
                        <p id="location-text" class="notion-body-medium"></p>
                    </div>

                    <!-- Budget Card -->
                    <div id="budget-card" style="display: none;">
                        <h3 class="notion-small mb-3">Budget</h3>
                        <p id="budget-text" class="notion-body-medium"></p>
                    </div>

                    <!-- Deadline Card -->
                    <div id="deadline-section" style="display: none;">
                        <h3 class="notion-small mb-3">å›ç­”æœŸé™</h3>
                        <p id="deadline-text" class="notion-body-medium"></p>
                    </div>
                </div>
            </div>
        </section>

        <div class="max-w-4xl mx-auto px-6 sm:px-8 lg:px-12 space-y-12 mt-12">

            <!-- Response Form CTA -->
            <section class="mt-12 text-center">
                <div class="enhanced-card card-hover response-cta p-8 text-center">
                    <div class="flex items-center space-x-3 mb-2">
                        <div class="w-1 h-6 rounded-full accent-bar"></div>
                        <h2 class="notion-heading-4">ã¾ã å›ç­”ã—ã¦ã„ãªã„æ–¹ã¸</h2>
                    </div>
                    <p class="notion-body mb-6">
                        ãœã²ã‚ãªãŸã®éƒ½åˆã‚’æ•™ãˆã¦ãã ã•ã„
                    </p>
                    <p class="notion-caption text-white/80 mb-6">ãƒ•ã‚©ãƒ¼ãƒ ã«å…¥åŠ›ã™ã‚‹ã¨ã€ä¸‹ã®å›ç­”çŠ¶æ³ã«ã™ãåæ˜ ã•ã‚Œã¾ã™ã€‚</p>
                        <button onclick="goToResponseForm()" class="interactive-element micro-transition inline-flex items-center px-6 py-3 bg-white hover:bg-slate-200 text-stone-900 font-semibold rounded-xl shadow-sm hover:shadow-md" aria-label="å›ç­”ãƒ•ã‚©ãƒ¼ãƒ ã«ç§»å‹•ã—ã¦å‚åŠ çŠ¶æ³ã‚’å…¥åŠ›ã™ã‚‹">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                        </svg>
                        å›ç­”ãƒ•ã‚©ãƒ¼ãƒ ã«å…¥åŠ›
                    </button>
                </div>
            </section>

            <!-- Beautiful Schedule Table -->
            <section class="animate-slide-up fade-in-up">
                <div class="enhanced-card card-hover overflow-hidden">
                    <div class="px-8 py-6 card-divider">
                        <div class="flex items-center justify-between mb-2">
                            <div class="flex items-center space-x-3">
                                <div class="w-1 h-6 bg-gradient-to-b from-gray-800 to-gray-900 rounded-full"></div>
                                <h2 class="notion-heading-4">
                                    æ—¥ç¨‹åˆ¥å›ç­”çŠ¶æ³
                                </h2>
                            </div>
                            <!-- è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ -->
                            <div class="flex bg-stone-100 rounded-lg p-1">
                <button id="chart-view-btn" class="px-4 py-2 rounded-md text-sm font-medium transition-all duration-200 bg-white shadow-sm text-stone-900 flex items-center space-x-2">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                    </svg>
                    <span>ã‚°ãƒ©ãƒ•</span>
                </button>
                <button id="table-view-btn" class="px-4 py-2 rounded-md text-sm font-medium transition-all duration-200 text-stone-600 hover:text-stone-900 flex items-center space-x-2">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path>
                    </svg>
                    <span>è¡¨</span>
                </button>
                            </div>
                        </div>
                        <p class="text-sm text-stone-600 leading-relaxed">å„å€™è£œæ—¥æ™‚ã®å‚åŠ è€…æ•°ã¨äººæ°—åº¦ã‚’ä¸€è¦§ã§ç¢ºèªã§ãã¾ã™</p>
                        <p class="notion-caption mt-2 text-stone-500">ã‚°ãƒ©ãƒ•ã¨è¡¨ã¯åŒã˜ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚çŠ¶æ³ã«å¿œã˜ã¦åˆ‡ã‚Šæ›¿ãˆã¦ãã ã•ã„ã€‚</p>
                    </div>

                    <!-- ã‚°ãƒ©ãƒ•è¡¨ç¤ºã‚¨ãƒªã‚¢ -->
                    <div id="chart-container" class="p-8">
                        <canvas id="schedule-chart" class="w-full" style="height: 400px;"></canvas>
                    </div>

                    <!-- ãƒ†ãƒ¼ãƒ–ãƒ«è¡¨ç¤ºã‚¨ãƒªã‚¢ -->
                    <div id="table-container" class="overflow-x-auto schedule-table" style="display: none;">
                        <table class="w-full notion-table" role="table" aria-label="æ—¥ç¨‹åˆ¥å›ç­”çŠ¶æ³ä¸€è¦§">
                            <thead>
                                <tr>
                                    <th class="text-left py-3 px-6 font-medium text-stone-700 text-sm" scope="col">
                                        <div class="flex flex-col items-start space-y-1">
                                            <span class="notion-body-medium text-stone-900">å€™è£œæ—¥æ™‚</span>
                                            <span class="notion-caption text-stone-500">é–‹å§‹ã€œçµ‚äº†</span>
                                        </div>
                                    </th>
                                    <th class="text-center py-3 px-4 font-medium text-stone-700 text-sm" scope="col">
                                        <div class="flex flex-col items-center space-y-1">
                                            <div class="flex items-center space-x-2">
                                                <span class="text-lg stat-icon--attending">â—‹</span>
                                                <span class="notion-body-medium">å‚åŠ </span>
                                            </div>
                                            <span class="notion-caption text-stone-500">å‡ºå¸­äºˆå®š</span>
                                        </div>
                                    </th>
                                    <th class="text-center py-3 px-4 font-medium text-stone-700 text-sm">
                                        <div class="flex flex-col items-center space-y-1">
                                            <div class="flex items-center space-x-2">
                                                <span class="text-lg stat-icon--maybe">?</span>
                                                <span class="notion-body-medium">æœªå®š</span>
                                            </div>
                                            <span class="notion-caption text-stone-500">æ¤œè¨ä¸­</span>
                                        </div>
                                    </th>
                                    <th class="text-center py-3 px-4 font-medium text-stone-700 text-sm">
                                        <div class="flex flex-col items-center space-y-1">
                                            <div class="flex items-center space-x-2">
                                                <span class="text-lg stat-icon--decline">Ã—</span>
                                                <span class="notion-body-medium">ä¸å‚åŠ </span>
                                            </div>
                                            <span class="notion-caption text-stone-500">æ¬ å¸­äºˆå®š</span>
                                        </div>
                                    </th>
                                    <th class="text-center py-3 px-4 font-medium text-stone-700 text-sm">
                                        <div class="flex flex-col items-center space-y-1">
                                            <span class="notion-body-medium">åˆè¨ˆ</span>
                                            <span class="notion-caption text-stone-500">å›ç­”äººæ•°</span>
                                        </div>
                                    </th>
                                    <th class="text-center py-3 px-6 font-medium text-stone-700 text-sm">
                                        <div class="flex flex-col items-center space-y-1">
                                            <span class="notion-body-medium">è©•ä¾¡</span>
                                            <span class="notion-caption text-stone-500">æ¨å¥¨åº¦</span>
                                        </div>
                                    </th>
                                </tr>
                            </thead>
                            <tbody class="">
                                <!-- å‹•çš„ã«ç”Ÿæˆã•ã‚Œã‚‹æ—¥ç¨‹åˆ¥å‚åŠ çŠ¶æ³ãŒã“ã“ã«æŒ¿å…¥ã•ã‚Œã¾ã™ -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Detailed Response Table -->
            <section class="mt-12 animate-fade-in fade-in-up">
                <div class="enhanced-card card-hover overflow-hidden">
                    <div class="px-8 py-6 card-divider">
                        <div class="flex items-center space-x-3 mb-2">
                            <div class="w-1 h-6 bg-gradient-to-b from-gray-700 to-gray-800 rounded-full"></div>
                            <h2 class="notion-heading-4">
                                å›ç­”ä¸€è¦§
                            </h2>
                        </div>
                        <p class="notion-caption">å…¨å‚åŠ è€…ã®è©³ç´°ãªå›ç­”çŠ¶æ³ã‚’ç¢ºèªãƒ»ç·¨é›†ã§ãã¾ã™ï¼ˆåå‰ã‚¯ãƒªãƒƒã‚¯ã§ç·¨é›†ï¼‰</p>
                    </div>

                    <div class="overflow-x-auto responses-table">
                        <table class="w-full table-fixed notion-table">
                            <thead>
                                <tr>
                                    <th class="text-left py-6 px-8 font-semibold text-gray-800 text-sm w-80">
                                        <span class="notion-body-medium">å‚åŠ è€…</span>
                                        <span class="block notion-caption text-stone-500 mt-1">ç·¨é›†ã™ã‚‹ã«ã¯åå‰ã‚’ã‚¿ãƒƒãƒ—</span>
                                    </th>
                                    <!-- æ—¥ç¨‹ãƒ˜ãƒƒãƒ€ãƒ¼ã¯å‹•çš„ã«ç”Ÿæˆã•ã‚Œã¾ã™ -->

                                </tr>
                            </thead>
                            <tbody class="">
                                <!-- å‹•çš„ã«ç”Ÿæˆã•ã‚Œã‚‹å›ç­”ä¸€è¦§ãŒã“ã“ã«æŒ¿å…¥ã•ã‚Œã¾ã™ -->
                            </tbody>
                        </table>
                    </div>

                    <!-- Show More Button -->
                    <div id="show-more-section" class="px-8 py-4 bg-stone-50/30 border-t border-stone-200/60 text-center">
                        <button id="show-more-button" class="inline-flex items-center px-4 py-2 bg-stone-100 hover:bg-stone-200 text-stone-700 font-medium rounded-lg transition-all duration-200 border border-stone-200" onclick="showMoreResponses()">
                            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                            </svg>
                            <span id="show-more-text">æ®‹ã‚Š15åã®å›ç­”ã‚’è¡¨ç¤º</span>
                        </button>
                    </div>
                </div>
            </section>


            <!-- URL Share Section -->
            <section class="mt-12 text-center">
                <div class="enhanced-card card-hover p-8">
                    <div class="flex items-center space-x-3 mb-2">
                        <div class="w-1 h-6 bg-gradient-to-b from-gray-500 to-gray-600 rounded-full"></div>
                        <h2 class="notion-heading-4">ã“ã®ã‚¤ãƒ™ãƒ³ãƒˆã®URL</h2>
                    </div>
                    <p class="notion-body mb-6">
                        ã“ã®URLã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ã€ä»–ã®å‚åŠ è€…ã«å…±æœ‰ã—ã¦ä¸‹ã•ã„
                    </p>
                    <p class="notion-caption text-stone-500 mb-6">å…±æœ‰ãƒªãƒ³ã‚¯ã‹ã‚‰ã¯å›ç­”çŠ¶æ³ã®é–²è¦§ã¨ã€æ–°è¦å›ç­”ã®è¿½åŠ ãŒå¯èƒ½ã§ã™ã€‚</p>
                    
                    <!-- URL Display Box -->
                    <div class="bg-gray-50 rounded-2xl p-6 mb-6 max-w-4xl mx-auto">
                        <div class="flex items-center justify-between bg-white rounded-xl p-4 shadow-soft">
                            <div class="flex-1 text-left">
                                <div class="notion-small mb-1">ã‚¤ãƒ™ãƒ³ãƒˆURL</div>
                                <div id="eventUrl" class="notion-mono break-all">
                                    <!-- URL will be populated by JavaScript -->
                                </div>
                            </div>
                            <button id="copyUrlBtn" onclick="copyEventUrl()" class="ml-4 interactive-element inline-flex items-center px-6 py-3 bg-stone-100 hover:bg-stone-200 text-stone-700 font-medium rounded-xl border border-stone-200 transition-all duration-200 hover:shadow-sm" aria-label="ã‚¤ãƒ™ãƒ³ãƒˆURLã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã™ã‚‹">
                                <svg id="copyIcon" class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                                </svg>
                                <span id="copyText">ã‚³ãƒ”ãƒ¼</span>
                            </button>
                        </div>
                    </div>

                    <!-- Share Tips -->
                    <div class="bg-stone-50 rounded-2xl p-6 max-w-3xl mx-auto">
                        <div class="flex items-start space-x-3">
                            <div class="flex-shrink-0 w-6 h-6 bg-stone-500 rounded-full flex items-center justify-center mt-0.5">
                                <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                </svg>
                            </div>
                            <div class="text-left">
                                <h3 class="notion-heading-4 mb-2">ã‚·ã‚§ã‚¢ã®ãƒ’ãƒ³ãƒˆ</h3>
                                <p class="notion-caption">
                                    ã“ã®URLã‚’LINEã®ã‚°ãƒ«ãƒ¼ãƒ—ãƒãƒ£ãƒƒãƒˆã‚„Slackã€ãƒ¡ãƒ¼ãƒ«ã§å…±æœ‰ã€‚å—ã‘å–ã£ãŸäººã¯å‚åŠ ã®å›ç­”ãŒã§ãã¾ã™ã€‚
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Footer -->
    <footer class="mt-20 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
            <div class="text-center">
                <!-- Logo and Title -->
                <div class="flex items-center justify-center space-x-3 mb-6">
                                            <img src="assets/App icon.png" alt="KANJY" class="w-10 h-10 rounded-lg shadow-soft">
                    <span class="text-2xl font-thin text-gray-900 tracking-widest uppercase">K A N J Y</span>
                </div>
                
                <!-- Main Description -->
                <p class="text-lg text-gray-600 mb-6">
                    å¹¹äº‹ã•ã‚“ã®è² æ‹…ã‚’æ¸›ã‚‰ã—ã€å‚åŠ è€…ã¿ã‚“ãªãŒæ¥½ã—ã‚ã‚‹é£²ã¿ä¼šã‚’ã€‚
                </p>
                
                <!-- App Description -->
                <div class="max-w-2xl mx-auto mb-8">
                    <p class="text-gray-600 mb-4">
                        KANJYã¯ã€æ—¥ç¨‹èª¿æ•´ã‹ã‚‰å‰²ã‚Šå‹˜ã¾ã§å¹¹äº‹ã•ã‚“ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ã€‚
                    </p>
                    
                    <!-- App Store Link -->
                    <a href="https://apps.apple.com/jp/app/kanjy/id6746665673" target="_blank" 
                       class="inline-flex items-center space-x-2 bg-gray-100 hover:bg-gray-200 transition-colors duration-200 px-6 py-3 rounded-xl">
                        <svg class="w-6 h-6 text-gray-700" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z"/>
                        </svg>
                        <span class="text-gray-700 font-medium">App Storeã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</span>
                    </a>
                </div>
                
                <!-- Copyright -->
                <div class="space-y-2">
                    <div class="flex items-center justify-center space-x-4 text-sm text-gray-500">
                        <span>Made by KANJY Team</span>
                        <span>â€¢</span>
                        <span>Â© 2025 KANJY</span>
                    </div>
                    <!-- Contact Info -->
                    <div class="flex items-center justify-center text-xs text-gray-400">
                        <span>ãŠå•ã„åˆã‚ã›: </span>
                        <a href="mailto:snaproom.info@gmail.com" class="ml-1 hover:text-kanjy-500 transition-colors duration-200">
                            snaproom.info@gmail.com
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Supabaseè¨­å®š
        const SUPABASE_URL = 'https://jvluhjifihiuopqdwjll.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp2bHVoamlmaWhpdW9wcWR3amxsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTExNTc5OTEsImV4cCI6MjA2NjczMzk5MX0.WDTzIs73X8NHGFcIYFk4CN-7dH5tQT5l0Bd2uY6H9lc';
        
        // Supabaseã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆåˆæœŸåŒ–ã¯DOMContentLoadedã®å¾Œï¼‰
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ã‚³ãƒ¼ãƒ—ã§å®£è¨€ã‚’é¿ã‘ã‚‹ãŸã‚ã€varã‚’ä½¿ç”¨
        var supabase;
        
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let currentEvent = null;
        let currentEventId = null;
        let currentResponses = [];
        
        // è¡¨ç¤ºåˆ¶é™æ©Ÿèƒ½ã®ãŸã‚ã®å¤‰æ•°
        let displayLimit = 5; // æœ€åˆã«è¡¨ç¤ºã™ã‚‹ä»¶æ•°
        let showingAll = false; // å…¨ä»¶è¡¨ç¤ºä¸­ã‹ã©ã†ã‹
        
        // ã€Œã‚‚ã£ã¨è¡¨ç¤ºã€ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯å‡¦ç†
        function showMoreResponses() {
            showingAll = true;
            displayResponses(currentResponses);
        }
        
        // Supabaseæ¥ç¶šã¨ãƒ‡ãƒ¼ã‚¿ç¢ºèª
        async function debugSupabaseConnection() {
            try {
                console.log('ğŸ” Supabaseæ¥ç¶šç¢ºèªé–‹å§‹');
                
                // 1. eventsãƒ†ãƒ¼ãƒ–ãƒ«ã®å…¨ä»¶ç¢ºèª
                const { data: allEvents, error: eventsError } = await supabase
                    .from('events')
                    .select('*');
                
                console.log('ğŸ“‹ eventsãƒ†ãƒ¼ãƒ–ãƒ«å…¨ä»¶:', { allEvents, eventsError });
                
                if (eventsError) {
                    console.error('âŒ eventsãƒ†ãƒ¼ãƒ–ãƒ«ã‚¢ã‚¯ã‚»ã‚¹ã‚¨ãƒ©ãƒ¼:', eventsError);
                } else {
                    console.log('âœ… eventsãƒ†ãƒ¼ãƒ–ãƒ«ä»¶æ•°:', allEvents?.length || 0);
                    if (allEvents && allEvents.length > 0) {
                        console.log('ğŸ“„ æœ€åˆã®ã‚¤ãƒ™ãƒ³ãƒˆ:', allEvents[0]);
                    }
                }
                
                // 2. responsesãƒ†ãƒ¼ãƒ–ãƒ«ã®å…¨ä»¶ç¢ºèª
                const { data: allResponses, error: responsesError } = await supabase
                    .from('responses')
                    .select('*');
                
                console.log('ğŸ“‹ responsesãƒ†ãƒ¼ãƒ–ãƒ«å…¨ä»¶:', { allResponses, responsesError });
                
                if (responsesError) {
                    console.error('âŒ responsesãƒ†ãƒ¼ãƒ–ãƒ«ã‚¢ã‚¯ã‚»ã‚¹ã‚¨ãƒ©ãƒ¼:', responsesError);
                } else {
                    console.log('âœ… responsesãƒ†ãƒ¼ãƒ–ãƒ«ä»¶æ•°:', allResponses?.length || 0);
                    if (allResponses && allResponses.length > 0) {
                        console.log('ğŸ“„ æœ€åˆã®å›ç­”:', allResponses[0]);
                    }
                }
                
                // 3. ç¾åœ¨ã®ã‚¤ãƒ™ãƒ³ãƒˆIDãŒå­˜åœ¨ã™ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
                if (currentEventId) {
                    const { data: targetEvent, error: targetError } = await supabase
                        .from('events')
                        .select('*')
                        .eq('id', currentEventId);
                    
                    console.log('ğŸ¯ å¯¾è±¡ã‚¤ãƒ™ãƒ³ãƒˆç¢ºèª:', { targetEvent, targetError, eventId: currentEventId });
                }
                
            } catch (error) {
                console.error('âŒ Supabaseæ¥ç¶šç¢ºèªã‚¨ãƒ©ãƒ¼:', error);
            }
        }
        
        // ã‚°ãƒ©ãƒ•å¤‰æ•°
        let scheduleChart = null;
        
        // æ—¥ç¨‹åˆ¥å›ç­”çŠ¶æ³ã‚°ãƒ©ãƒ•ã‚’ä½œæˆ
        function createScheduleChart(responses) {
            const canvas = document.getElementById('schedule-chart');
            if (!canvas || !currentEvent) {
                console.warn('âš ï¸ ã‚°ãƒ©ãƒ•ä½œæˆã‚’ã‚¹ã‚­ãƒƒãƒ—: canvas ã¾ãŸã¯ currentEvent ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                return;
            }
            
            // Chart.jsã®èª­ã¿è¾¼ã¿ç¢ºèª
            if (typeof Chart === 'undefined') {
                console.error('âŒ Chart.jsãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã›ã‚“');
                return;
            }
            
            // ãƒ‡ãƒ¼ã‚¿ã®æ§‹é€ ã‚’ãƒ‡ãƒãƒƒã‚°
            console.log('ğŸ” ã‚°ãƒ©ãƒ•ä½œæˆé–‹å§‹');
            console.log('ğŸ” responses:', responses);
            console.log('ğŸ” currentEvent:', currentEvent);
            console.log('ğŸ” candidate_dates:', currentEvent.candidate_dates);
            
            // å›ç­”ãƒ‡ãƒ¼ã‚¿ã®æ§‹é€ ã‚’ç¢ºèª
            if (responses && responses.length > 0) {
                console.log('ğŸ” æœ€åˆã®å›ç­”ãƒ‡ãƒ¼ã‚¿:', responses[0]);
                console.log('ğŸ” date_responsesæ§‹é€ :', responses[0].date_responses);
                
                // å…¨å›ç­”ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å€¤ã‚’ä¸€è¦§è¡¨ç¤º
                const statusList = responses.map(r => ({ name: r.participant_name, status: r.status }));
                console.log('ğŸ” å…¨å›ç­”ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ä¸€è¦§:', statusList);
                
                // ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å€¤ã‚’æŠ½å‡º
                const uniqueStatuses = [...new Set(responses.map(r => r.status))];
                console.log('ğŸ” ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å€¤:', uniqueStatuses);
            }
            
            // æ—¢å­˜ã®ã‚°ãƒ©ãƒ•ã‚’ç ´æ£„
            if (scheduleChart) {
                scheduleChart.destroy();
            }
            
            // å®Ÿéš›ã®å€™è£œæ—¥ç¨‹ã‚’ä½¿ç”¨ï¼ˆãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã¯å‰Šé™¤ï¼‰
            let actualDates = currentEvent.candidate_dates || [];
            
            // ã‚°ãƒ©ãƒ•ã§ã‚‚é‡è¤‡é™¤å»
            const uniqueGraphDates = [...new Set(actualDates)];
            if (actualDates.length !== uniqueGraphDates.length) {
                console.warn('ğŸ”§ ã‚°ãƒ©ãƒ•ç”¨ãƒ‡ãƒ¼ã‚¿ã§ã‚‚é‡è¤‡ã‚’é™¤å»:', actualDates.length, 'â†’', uniqueGraphDates.length);
                actualDates = uniqueGraphDates;
            }
            
            console.log('å®Ÿéš›ã®å€™è£œæ—¥ç¨‹:', actualDates);
            
            // å„å€™è£œæ—¥æ™‚ã®çµ±è¨ˆã‚’è¨ˆç®—
            const dateStats = actualDates.map(dateStr => {
                const date = new Date(dateStr);
                const label = `${date.getMonth() + 1}/${date.getDate()} ${date.getHours().toString().padStart(2, '0')}:${date.getMinutes().toString().padStart(2, '0')}`;
                
                console.log(`æ—¥ä»˜å‡¦ç†ä¸­: ${dateStr} -> ${label}`);
                
                // è¡¨ã®è¡¨ç¤ºãƒ­ã‚¸ãƒƒã‚¯ã¨åŒã˜åˆ¤å®šã‚’ä½¿ç”¨ã—ã¦ã‚«ã‚¦ãƒ³ãƒˆ
                let attending = 0;
                let maybe = 0;
                let notAttending = 0;
                
                responses.forEach(response => {
                    // è¡¨ã®è¡¨ç¤ºãƒ­ã‚¸ãƒƒã‚¯ã¨åŒã˜åˆ¤å®šã‚’ä½¿ç”¨
                    const tableStatus = getStatusForDate(response, dateStr);
                    
                    if (tableStatus === 'attending') {
                        attending++;
                        console.log(`âœ… ${response.participant_name}: å‚åŠ `);
                    } else if (tableStatus === 'maybe') {
                        maybe++;
                        console.log(`âš ï¸ ${response.participant_name}: æœªå®š`);
                    } else {
                        notAttending++;
                        console.log(`âŒ ${response.participant_name}: ä¸å‚åŠ `);
                    }
                });
                
                console.log(`${label}: å‚åŠ =${attending}, ä¸å‚åŠ =${notAttending}, æœªå®š=${maybe}`);
                
                return {
                    label,
                    attending,
                    notAttending,
                    maybe,
                    total: attending + notAttending + maybe
                };
            });
            
            const ctx = canvas.getContext('2d');
            
            // å‚åŠ è€…æ•°ã®æœ€å¤§å€¤ã‚’å–å¾—ã—ã¦å¼·å¼±ã‚’è¨ˆç®—
            const attendingCounts = dateStats.map(stat => stat.attending);
            const maxAttending = Math.max(...attendingCounts);
            
            // æœ€ã‚‚å‚åŠ è€…ãŒå¤šã„æ—¥ç¨‹ã®ã¿ç·‘è‰²ã€ä»–ã¯ã‚°ãƒ¬ãƒ¼ï¼ˆNotioné¢¨ã‚«ãƒ©ãƒ¼ï¼‰
            const backgroundColors = attendingCounts.map(count => {
                if (maxAttending === 0) return 'rgba(153, 27, 27, 0.1)'; // å…¨ã¦0ã®å ´åˆã¯è–„ã„èµ¤
                if (count === maxAttending && count > 0) {
                    return 'rgba(15, 123, 15, 0.8)'; // Notioné¢¨ç·‘ - æœ€äººæ°—ã®æ—¥ç¨‹ã®ã¿
                } else {
                    return 'rgba(107, 114, 128, 0.3)'; // ã‚°ãƒ¬ãƒ¼ - ãã®ä»–ã®æ—¥ç¨‹
                }
            });
            
            const borderColors = attendingCounts.map(count => {
                if (maxAttending === 0) return 'rgba(153, 27, 27, 0.4)'; // å…¨ã¦0ã®å ´åˆ
                if (count === maxAttending && count > 0) {
                    return 'rgba(15, 123, 15, 1.0)'; // Notioné¢¨ç·‘ - æœ€äººæ°—ã®æ—¥ç¨‹ã®ã¿
                } else {
                    return 'rgba(75, 85, 99, 0.5)'; // ã‚°ãƒ¬ãƒ¼ - ãã®ä»–ã®æ—¥ç¨‹
                }
            });
            
            console.log('æœ€å¤§å‚åŠ è€…æ•°:', maxAttending);
            console.log('è‰²ä»˜ã‘å¯¾è±¡:', attendingCounts.map((count, index) => 
                count === maxAttending && count > 0 ? `${dateStats[index].label}: ç·‘è‰²` : `${dateStats[index].label}: ã‚°ãƒ¬ãƒ¼`
            ));
            
            scheduleChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: dateStats.map(stat => stat.label),
                    datasets: [{
                        label: 'å‚åŠ è€…æ•°',
                        data: attendingCounts,
                        backgroundColor: backgroundColors,
                        borderColor: borderColors,
                        borderWidth: 1,
                        borderRadius: 2,
                        borderSkipped: false,
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'æ—¥ç¨‹åˆ¥å‚åŠ è€…æ•°',
                            font: {
                                size: 16,
                                weight: 'bold'
                            },
                            color: '#37352F'
                        },
                        legend: {
                            display: false // ã‚·ãƒ³ãƒ—ãƒ«ã«ã™ã‚‹ãŸã‚å‡¡ä¾‹ã‚’éè¡¨ç¤º
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleFont: {
                                size: 14,
                                weight: 'bold'
                            },
                            bodyFont: {
                                size: 13
                            },
                            callbacks: {
                                label: function(context) {
                                    const dataIndex = context.dataIndex;
                                    const stats = dateStats[dataIndex];
                                    
                                    console.log('ğŸ” ã‚°ãƒ©ãƒ•ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—:', {
                                        dataIndex,
                                        label: stats.label,
                                        attending: stats.attending,
                                        maybe: stats.maybe,
                                        notAttending: stats.notAttending,
                                        total: stats.total
                                    });
                                    
                                    const attending = stats.attending;
                                    const notAttending = stats.notAttending;
                                    const maybe = stats.maybe;
                                    const total = stats.total;
                                    
                                    const isTopChoice = attending === maxAttending && attending > 0;
                                    const topChoiceLabel = isTopChoice ? 'ã€æœ€äººæ°—ã®æ—¥ç¨‹ã€‘' : '';
                                    
                                    return [
                                        topChoiceLabel,
                                        `å‚åŠ : ${attending}å`,
                                        `æœªå®š: ${maybe}å`, 
                                        `ä¸å‚åŠ : ${notAttending}å`,
                                        `åˆè¨ˆå›ç­”: ${total}å`
                                    ].filter(Boolean); // ç©ºæ–‡å­—åˆ—ã‚’é™¤å¤–
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'å€™è£œæ—¥æ™‚',
                                color: '#6B6B6B',
                                font: {
                                    size: 12,
                                    weight: 'bold'
                                }
                            },
                            grid: {
                                display: false
                            },
                            border: {
                                color: '#e5e7eb'
                            },
                            ticks: {
                                color: '#6B6B6B',
                                font: {
                                    size: 11
                                }
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'å‚åŠ è€…æ•°',
                                color: '#6B6B6B',
                                font: {
                                    size: 12,
                                    weight: 'bold'
                                }
                            },
                            beginAtZero: true,
                            grid: {
                                color: '#f9fafb',
                                borderColor: '#e5e7eb',
                                borderWidth: 1
                            },
                            ticks: {
                                color: '#6B6B6B',
                                font: {
                                    size: 11
                                },
                                stepSize: 1
                            }
                        }
                    },
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    },
                    animation: {
                        duration: 1000,
                        easing: 'easeInOutQuart'
                    }
                }
            });
            
            console.log('æ—¥ç¨‹åˆ¥å›ç­”çŠ¶æ³ã‚°ãƒ©ãƒ•ã‚’ä½œæˆã—ã¾ã—ãŸ');
            console.log('ã‚°ãƒ©ãƒ•ãƒ‡ãƒ¼ã‚¿:', dateStats);
            console.log('å›ç­”ãƒ‡ãƒ¼ã‚¿ä»¶æ•°:', responses.length);
        }
        
        // è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆæ©Ÿèƒ½
        function initializeViewToggle() {
            const chartViewBtn = document.getElementById('chart-view-btn');
            const tableViewBtn = document.getElementById('table-view-btn');
            const chartContainer = document.getElementById('chart-container');
            const tableContainer = document.getElementById('table-container');
            
            if (!chartViewBtn || !tableViewBtn || !chartContainer || !tableContainer) return;
            
            // ã‚°ãƒ©ãƒ•è¡¨ç¤º
            chartViewBtn.addEventListener('click', function() {
                chartContainer.style.display = 'block';
                tableContainer.style.display = 'none';
                
                chartViewBtn.classList.add('bg-white', 'shadow-sm', 'text-gray-900');
                chartViewBtn.classList.remove('text-gray-600', 'hover:text-gray-900');
                
                tableViewBtn.classList.remove('bg-white', 'shadow-sm', 'text-gray-900');
                tableViewBtn.classList.add('text-gray-600', 'hover:text-gray-900');
            });
            
            // è¡¨è¡¨ç¤º
            tableViewBtn.addEventListener('click', function() {
                chartContainer.style.display = 'none';
                tableContainer.style.display = 'block';
                
                tableViewBtn.classList.add('bg-white', 'shadow-sm', 'text-gray-900');
                tableViewBtn.classList.remove('text-gray-600', 'hover:text-gray-900');
                
                chartViewBtn.classList.remove('bg-white', 'shadow-sm', 'text-gray-900');
                chartViewBtn.classList.add('text-gray-600', 'hover:text-gray-900');
            });
        }
        
        
        // åˆæœŸåŒ–
        // Supabaseãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®èª­ã¿è¾¼ã¿ã‚’å¾…ã¤
        function waitForSupabase() {
            return new Promise((resolve, reject) => {
                if (typeof window.supabase !== 'undefined') {
                    resolve();
                    return;
                }
                
                let attempts = 0;
                const maxAttempts = 50; // 5ç§’å¾…æ©Ÿ
                const checkInterval = setInterval(() => {
                    attempts++;
                    if (typeof window.supabase !== 'undefined') {
                        clearInterval(checkInterval);
                        resolve();
                    } else if (attempts >= maxAttempts) {
                        clearInterval(checkInterval);
                        reject(new Error('Supabaseãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®èª­ã¿è¾¼ã¿ãŒã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸ'));
                    }
                }, 100);
            });
        }
        
        // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºã‚’æ›´æ–°ã™ã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
        function updateLoadingStatus(message) {
            const statusElement = document.getElementById('loading-status');
            if (statusElement) {
                statusElement.textContent = `ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: ${message}`;
                statusElement.style.display = 'block';
            }
            console.log(`ğŸ“Š ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: ${message}`);
        }
        
        // ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºã‚’æ›´æ–°ã™ã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
        function showError(message) {
            const errorElement = document.getElementById('error-display');
            if (errorElement) {
                errorElement.textContent = message;
                errorElement.style.display = 'block';
            }
            console.error(`âŒ ã‚¨ãƒ©ãƒ¼: ${message}`);
        }
        
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('ğŸ™ KANJYåˆæœŸåŒ–é–‹å§‹');
            updateLoadingStatus('åˆæœŸåŒ–é–‹å§‹');
            
            try {
                // Supabaseãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®èª­ã¿è¾¼ã¿ã‚’å¾…ã¤
                updateLoadingStatus('Supabaseãƒ©ã‚¤ãƒ–ãƒ©ãƒªèª­ã¿è¾¼ã¿ä¸­...');
                console.log('â³ Supabaseãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®èª­ã¿è¾¼ã¿ã‚’å¾…æ©Ÿä¸­...');
                await waitForSupabase();
                console.log('âœ… Supabaseãƒ©ã‚¤ãƒ–ãƒ©ãƒªèª­ã¿è¾¼ã¿å®Œäº†');
                updateLoadingStatus('Supabaseã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆåˆæœŸåŒ–ä¸­...');
                
                // Supabaseã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆåˆæœŸåŒ–
                console.log('ğŸ”§ Supabaseã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆåˆæœŸåŒ–é–‹å§‹');
                console.log('ğŸ”§ window.supabase:', typeof window.supabase);
                if (typeof window.supabase === 'undefined') {
                    throw new Error('Supabaseãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã›ã‚“');
                }
                supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
                console.log('âœ… Supabaseã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆåˆæœŸåŒ–å®Œäº†');
                updateLoadingStatus('ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šãƒ†ã‚¹ãƒˆä¸­...');
                
                // Supabaseæ¥ç¶šãƒ†ã‚¹ãƒˆï¼ˆã‚·ãƒ³ãƒ—ãƒ«ãªã‚¯ã‚¨ãƒªã§ç¢ºèªï¼‰
                console.log('ğŸ” Supabaseæ¥ç¶šãƒ†ã‚¹ãƒˆé–‹å§‹');
                console.log('ğŸ” Supabase URL:', SUPABASE_URL);
                console.log('ğŸ” Supabase Key:', SUPABASE_ANON_KEY.substring(0, 20) + '...');
                
                try {
                    // ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã‚’è¨­å®šï¼ˆ10ç§’ï¼‰
                    let timeoutId;
                    const timeoutPromise = new Promise((_, reject) => {
                        timeoutId = setTimeout(() => reject(new Error('æ¥ç¶šã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼ˆ10ç§’ä»¥å†…ã«å¿œç­”ãŒã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸï¼‰')), 10000);
                    });
                    
                    const queryPromise = supabase
                        .from('events')
                        .select('id')
                        .limit(1)
                        .then(result => {
                            clearTimeout(timeoutId);
                            return result;
                        });
                    
                    const result = await Promise.race([queryPromise, timeoutPromise]);
                    const { data: testData, error: testError } = result;
                    
                    if (testError) {
                        console.error('âŒ Supabaseæ¥ç¶šãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼:', testError);
                        console.error('âŒ ã‚¨ãƒ©ãƒ¼è©³ç´°:', JSON.stringify(testError, null, 2));
                        console.error('âŒ ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰:', testError.code);
                        console.error('âŒ ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸:', testError.message);
                        
                        let errorMessage = 'ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®æ¥ç¶šã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚';
                        if (testError.message) {
                            errorMessage += `\n\nè©³ç´°: ${testError.message}`;
                        }
                        if (testError.code === 'PGRST116' || testError.message?.includes('not found')) {
                            errorMessage += '\n\nãƒ†ãƒ¼ãƒ–ãƒ«ã€Œeventsã€ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚';
                        } else if (testError.code === '42501' || testError.message?.includes('permission')) {
                            errorMessage += '\n\nãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“ã€‚RLSãƒãƒªã‚·ãƒ¼ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚';
                        } else if (testError.message?.includes('network') || testError.message?.includes('fetch')) {
                            errorMessage += '\n\nãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚';
                        }
                        
                        throw new Error(errorMessage);
                    } else {
                        console.log('âœ… Supabaseæ¥ç¶šãƒ†ã‚¹ãƒˆæˆåŠŸ');
                        console.log('âœ… ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿:', testData);
                        updateLoadingStatus('ã‚¤ãƒ™ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ä¸­...');
                    }
                } catch (testError) {
                    console.error('âŒ Supabaseæ¥ç¶šãƒ†ã‚¹ãƒˆå¤±æ•—:', testError);
                    if (testError.message?.includes('ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ')) {
                        throw new Error('ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®æ¥ç¶šãŒã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸã€‚Supabaseãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚');
                    }
                    throw testError;
                }
            } catch (error) {
                console.error('âŒ SupabaseåˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:', error);
                console.error('âŒ ã‚¨ãƒ©ãƒ¼ã‚¹ã‚¿ãƒƒã‚¯:', error.stack);
                updateLoadingStatus('ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ');
                const titleElement = document.getElementById('event-title');
                if (titleElement) {
                    titleElement.textContent = 'ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®æ¥ç¶šã«å¤±æ•—ã—ã¾ã—ãŸ';
                    titleElement.style.color = '#ef4444';
                }
                
                let errorMessage = 'ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®æ¥ç¶šã«å¤±æ•—ã—ã¾ã—ãŸã€‚\n\n';
                if (error.message) {
                    errorMessage += `è©³ç´°: ${error.message}\n\n`;
                }
                if (error.stack) {
                    errorMessage += `ã‚¹ã‚¿ãƒƒã‚¯:\n${error.stack}\n\n`;
                }
                errorMessage += 'è€ƒãˆã‚‰ã‚Œã‚‹åŸå› :\n';
                errorMessage += '1. ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„\n';
                errorMessage += '2. Supabaseãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒèµ·å‹•ã—ã¦ã„ãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™\n';
                errorMessage += '3. ãƒšãƒ¼ã‚¸ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦å†è©¦è¡Œã—ã¦ãã ã•ã„';
                
                showError(errorMessage);
                return;
            }
            
            // URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰ã‚¤ãƒ™ãƒ³ãƒˆIDã‚’å–å¾—
            const urlParams = new URLSearchParams(window.location.search);
            let eventId = urlParams.get('id');
            
            if (!eventId) {
                alert('ã‚¤ãƒ™ãƒ³ãƒˆIDãŒæŒ‡å®šã•ã‚Œã¦ã„ã¾ã›ã‚“');
                return;
            }
            
            // UUIDã‚’å°æ–‡å­—ã«çµ±ä¸€ï¼ˆiOSã‚¢ãƒ—ãƒªå´ã§lowercased()ã§ä¿å­˜ã—ã¦ã„ã‚‹ãŸã‚ï¼‰
            eventId = eventId.toLowerCase().trim();
            console.log('ğŸ” ã‚¤ãƒ™ãƒ³ãƒˆID:', eventId);
            
            currentEventId = eventId;
            
            try {
                // debugSupabaseConnectionã¯æ™‚é–“ãŒã‹ã‹ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã‚¹ã‚­ãƒƒãƒ—
                // console.log('ğŸ“Š ã‚¹ãƒ†ãƒƒãƒ—1: Supabaseæ¥ç¶šç¢ºèªã‚’é–‹å§‹');
                // try {
                //     await debugSupabaseConnection();
                //     console.log('âœ… ã‚¹ãƒ†ãƒƒãƒ—1å®Œäº†: Supabaseæ¥ç¶šç¢ºèªæˆåŠŸ');
                // } catch (debugError) {
                //     console.warn('âš ï¸ ã‚¹ãƒ†ãƒƒãƒ—1è­¦å‘Š: Supabaseæ¥ç¶šç¢ºèªã§ã‚¨ãƒ©ãƒ¼ï¼ˆç¶šè¡Œã—ã¾ã™ï¼‰:', debugError);
                // }
                
                console.log('ğŸ“Š ã‚¹ãƒ†ãƒƒãƒ—1: ã‚¤ãƒ™ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚’é–‹å§‹');
                updateLoadingStatus('ã‚¤ãƒ™ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ä¸­...');
                // ã‚¤ãƒ™ãƒ³ãƒˆã‚’æœ€åˆã«èª­ã¿è¾¼ã¿ï¼ˆãƒ˜ãƒƒãƒ€ãƒ¼ç”Ÿæˆã®ãŸã‚ï¼‰
                await loadEvent(eventId);
                console.log('âœ… ã‚¹ãƒ†ãƒƒãƒ—1å®Œäº†: ã‚¤ãƒ™ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿æˆåŠŸ');
                updateLoadingStatus('å›ç­”ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ä¸­...');
                
                console.log('ğŸ“Š ã‚¹ãƒ†ãƒƒãƒ—2: å›ç­”ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚’é–‹å§‹');
                // æ¬¡ã«å›ç­”ã‚’èª­ã¿è¾¼ã¿ï¼ˆãƒ˜ãƒƒãƒ€ãƒ¼ç”Ÿæˆå¾Œï¼‰
                await loadResponses(eventId);
                console.log('âœ… ã‚¹ãƒ†ãƒƒãƒ—2å®Œäº†: å›ç­”ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿æˆåŠŸ');
                
                console.log('ğŸ™ ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å®Œäº†');
                updateLoadingStatus('èª­ã¿è¾¼ã¿å®Œäº†');
                
                // è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆæ©Ÿèƒ½ã‚’åˆæœŸåŒ–
                initializeViewToggle();
                
                // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºã‚’éè¡¨ç¤º
                setTimeout(() => {
                    const statusElement = document.getElementById('loading-status');
                    if (statusElement) {
                        statusElement.style.display = 'none';
                    }
                }, 1000);
                
            } catch (error) {
                console.error('âŒ åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:', error);
                console.error('âŒ åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼è©³ç´°:', error.message);
                console.error('âŒ åˆæœŸåŒ–ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹:', error.stack);
                updateLoadingStatus('ã‚¨ãƒ©ãƒ¼: ' + (error.message || 'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼'));
                
                // ã‚¨ãƒ©ãƒ¼æ™‚ã«ã‚¿ã‚¤ãƒˆãƒ«ã‚’æ›´æ–°
                const titleElement = document.getElementById('event-title');
                if (titleElement) {
                    titleElement.textContent = 'ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ';
                    titleElement.style.color = '#ef4444';
                }
                
                // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
                let userMessage = 'ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚\n\n';
                if (error.message) {
                    userMessage += `è©³ç´°: ${error.message}\n\n`;
                }
                if (error.stack) {
                    userMessage += `ã‚¹ã‚¿ãƒƒã‚¯:\n${error.stack}\n\n`;
                }
                userMessage += 'ãƒšãƒ¼ã‚¸ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚';
                
                showError(userMessage);
            }
            
            // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š
            setupAnimations();
            
            console.log('ğŸ‰ Beautiful KANJY Table loaded successfully!');
        });
        
        // ã‚¤ãƒ™ãƒ³ãƒˆæƒ…å ±ã‚’èª­ã¿è¾¼ã¿
        async function loadEvent(eventId) {
            try {
                console.log('ğŸ“¥ ã‚¤ãƒ™ãƒ³ãƒˆèª­ã¿è¾¼ã¿é–‹å§‹:', eventId);
                console.log('ğŸ“¥ ã‚¤ãƒ™ãƒ³ãƒˆIDã®å‹:', typeof eventId);
                console.log('ğŸ“¥ ã‚¤ãƒ™ãƒ³ãƒˆIDã®å€¤:', JSON.stringify(eventId));
                
                // Supabaseã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œï¼ˆé…åˆ—ã§å–å¾—ï¼‰
                console.log('ğŸ“¥ Supabaseã‚¯ã‚¨ãƒªå®Ÿè¡Œå‰');
                console.log('ğŸ“¥ supabaseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ:', supabase);
                console.log('ğŸ“¥ ã‚¯ã‚¨ãƒªå¯¾è±¡ã‚¤ãƒ™ãƒ³ãƒˆID:', eventId);
                
                const queryStartTime = Date.now();
                let queryResult;
                try {
                    console.log('ğŸ“¥ Supabaseã‚¯ã‚¨ãƒªå®Ÿè¡Œä¸­...');
                    queryResult = await supabase
                        .from('events')
                        .select('*')
                        .eq('id', eventId);
                    const queryEndTime = Date.now();
                    console.log(`ğŸ“¥ Supabaseã‚¯ã‚¨ãƒªå®Ÿè¡Œå®Œäº†ï¼ˆ${queryEndTime - queryStartTime}msï¼‰`);
                } catch (queryError) {
                    const queryEndTime = Date.now();
                    console.error(`âŒ Supabaseã‚¯ã‚¨ãƒªå®Ÿè¡Œã‚¨ãƒ©ãƒ¼ï¼ˆ${queryEndTime - queryStartTime}msï¼‰:`, queryError);
                    throw queryError;
                }
                
                const { data: events, error } = queryResult;
                
                console.log('ğŸ” Supabaseã‚¯ã‚¨ãƒªçµæœ:');
                console.log('  - ãƒ‡ãƒ¼ã‚¿:', events);
                console.log('  - ãƒ‡ãƒ¼ã‚¿å‹:', typeof events);
                console.log('  - ã‚¨ãƒ©ãƒ¼:', error);
                console.log('  - ãƒ‡ãƒ¼ã‚¿ä»¶æ•°:', events ? events.length : 0);
                
                if (error) {
                    console.error('âŒ Supabaseã‚¨ãƒ©ãƒ¼:', error);
                    throw error;
                }
                
                if (!events || events.length === 0) {
                    console.warn('âš ï¸ ã‚¤ãƒ™ãƒ³ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚åˆ©ç”¨å¯èƒ½ãªã‚¤ãƒ™ãƒ³ãƒˆã‚’ç¢ºèªä¸­...');
                    // ã‚¤ãƒ™ãƒ³ãƒˆãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã€åˆ©ç”¨å¯èƒ½ãªã‚¤ãƒ™ãƒ³ãƒˆã‚’è¡¨ç¤º
                    const { data: availableEvents, error: availableError } = await supabase
                        .from('events')
                        .select('id, title, created_at')
                        .order('created_at', { ascending: false })
                        .limit(5);
                    
                    console.log('åˆ©ç”¨å¯èƒ½ãªã‚¤ãƒ™ãƒ³ãƒˆ:', availableEvents);
                    
                    let errorMessage = `ã‚¤ãƒ™ãƒ³ãƒˆID "${eventId}" ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚`;
                    if (availableEvents && availableEvents.length > 0) {
                        errorMessage += '\n\nåˆ©ç”¨å¯èƒ½ãªã‚¤ãƒ™ãƒ³ãƒˆ:';
                        availableEvents.forEach(event => {
                            errorMessage += `\n- ${event.title || 'ã‚¿ã‚¤ãƒˆãƒ«ãªã—'} (ID: ${event.id})`;
                        });
                    }
                    
                    throw new Error(errorMessage);
                }
                
                const event = events[0];
                
                // ã‚¤ãƒ™ãƒ³ãƒˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æ¤œè¨¼
                if (!event) {
                    throw new Error('ã‚¤ãƒ™ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿ãŒä¸æ­£ã§ã™');
                }
                
                // ã‚¿ã‚¤ãƒˆãƒ«ã®æ¤œè¨¼
                if (!event.title || event.title.trim() === '') {
                    console.warn('âš ï¸ ã‚¤ãƒ™ãƒ³ãƒˆã‚¿ã‚¤ãƒˆãƒ«ãŒç©ºã§ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’è¨­å®šã—ã¾ã™ã€‚');
                    event.title = 'ã‚¤ãƒ™ãƒ³ãƒˆåãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“';
                }
                
                console.log('ğŸ” æœ€åˆã®ã‚¤ãƒ™ãƒ³ãƒˆè©³ç´°:');
                console.log('  - ID:', event.id);
                console.log('  - ã‚¿ã‚¤ãƒˆãƒ«:', event.title);
                console.log('  - candidate_dates:', event.candidate_dates);
                console.log('  - candidate_dateså‹:', typeof event.candidate_dates);
                console.log('  - candidate_datesé•·ã•:', event.candidate_dates ? event.candidate_dates.length : 'null');
                
                if (event.candidate_dates && Array.isArray(event.candidate_dates)) {
                    event.candidate_dates.forEach((date, index) => {
                        console.log(`  - æ—¥ä»˜${index + 1}:`, date);
                    });
                }
                
                // æ™‚é–“ãƒ‡ãƒ¼ã‚¿ã‚’ä¿®æ­£ï¼ˆ19:00 UTC â†’ 10:00 UTC ã«å¤‰æ›ã—ã¦19:00 JSTã§è¡¨ç¤ºï¼‰
                if (event.candidate_dates) {
                    event.candidate_dates = event.candidate_dates.map(dateStr => {
                        const date = new Date(dateStr);
                        if (date.getUTCHours() === 19) {
                            // 19:00 UTCã‚’10:00 UTCã«å¤‰æ›´ï¼ˆæ—¥æœ¬æ™‚é–“19:00ã«ã™ã‚‹ãŸã‚ï¼‰
                            date.setUTCHours(10);
                            return date.toISOString();
                        }
                        return dateStr;
                    });
                    console.log('ğŸ”§ æ™‚é–“ãƒ‡ãƒ¼ã‚¿ä¿®æ­£å®Œäº†:', event.candidate_dates);
                }
                
                currentEvent = event;
                console.log('ğŸ”§ currentEventè¨­å®šå®Œäº†:');
                console.log('  - ID:', event.id);
                console.log('  - ã‚¿ã‚¤ãƒˆãƒ«:', event.title);
                console.log('  - candidate_dates:', event.candidate_dates);
                console.log('  - currentEvent.candidate_dates:', currentEvent.candidate_dates);
                
                // è¨­å®šç›´å¾Œã«é‡è¤‡ãƒã‚§ãƒƒã‚¯
                if (currentEvent.candidate_dates && Array.isArray(currentEvent.candidate_dates)) {
                    const uniqueCheck = [...new Set(currentEvent.candidate_dates)];
                    console.log('ğŸ”§ è¨­å®šç›´å¾Œã®é‡è¤‡ãƒã‚§ãƒƒã‚¯:');
                    console.log('  - å…ƒã®é•·ã•:', currentEvent.candidate_dates.length);
                    console.log('  - é‡è¤‡é™¤å»å¾Œ:', uniqueCheck.length);
                    if (currentEvent.candidate_dates.length !== uniqueCheck.length) {
                        console.warn('âš ï¸ currentEventè¨­å®šæ™‚ç‚¹ã§æ—¢ã«é‡è¤‡ãŒã‚ã‚Šã¾ã™!');
                        console.log('  - é‡è¤‡ã‚ã‚Š:', currentEvent.candidate_dates);
                        console.log('  - é‡è¤‡é™¤å»å¾Œ:', uniqueCheck);
                    }
                }
                // ã‚¤ãƒ™ãƒ³ãƒˆæƒ…å ±ã‚’è¡¨ç¤ºï¼ˆå³åº§ã«å®Ÿè¡Œï¼‰
                console.log('âœ… ã‚¤ãƒ™ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿å–å¾—æˆåŠŸã€è¡¨ç¤ºå‡¦ç†ã‚’é–‹å§‹');
                console.log('âœ… ã‚¤ãƒ™ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿:', JSON.stringify(event, null, 2));
                displayEvent(event);
                console.log('âœ… displayEventå‘¼ã³å‡ºã—å®Œäº†');
                
            } catch (error) {
                console.error('âŒ ã‚¤ãƒ™ãƒ³ãƒˆèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
                console.error('âŒ ã‚¨ãƒ©ãƒ¼è©³ç´°:', error.message);
                console.error('âŒ ã‚¨ãƒ©ãƒ¼ã‚¹ã‚¿ãƒƒã‚¯:', error.stack);
                
                // ã‚¨ãƒ©ãƒ¼æ™‚ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«åˆ†ã‹ã‚Šã‚„ã™ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
                const titleElement = document.getElementById('event-title');
                if (titleElement) {
                    titleElement.textContent = 'ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ';
                    titleElement.style.color = '#ef4444'; // ã‚¨ãƒ©ãƒ¼è‰²
                }
                
                // ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
                const errorMessage = error.message || 'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ';
                alert(`ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ:\n\n${errorMessage}\n\nãƒšãƒ¼ã‚¸ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚`);
                
                throw error;
            }
        }
        
        // å›ç­”ã‚’èª­ã¿è¾¼ã¿
        async function loadResponses(eventId) {
            try {
                console.log('å›ç­”èª­ã¿è¾¼ã¿é–‹å§‹:', eventId);
                
                const { data: responses, error } = await supabase
                    .from('responses')
                    .select('*')
                    .eq('event_id', eventId)
                    .order('created_at', { ascending: false });
                
                console.log('å›ç­”ã‚¯ã‚¨ãƒªçµæœ:', { responses, error });
                
                if (error) throw error;
                
                // å‰Šé™¤æ¸ˆã¿ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
                const activeResponses = (responses || []).filter(response => {
                    const isDeleted = response.participant_name && response.participant_name.startsWith('[å‰Šé™¤æ¸ˆã¿]');
                    if (isDeleted) {
                        console.log('ğŸ—‘ï¸ å‰Šé™¤æ¸ˆã¿ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’éè¡¨ç¤º:', response.participant_name);
                    }
                    return !isDeleted;
                });
                
                console.log('ğŸ“Š ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°çµæœ:', {
                    total: responses ? responses.length : 0,
                    deleted: responses ? responses.length - activeResponses.length : 0,
                    active: activeResponses.length
                });
                
                // å›ç­”ãƒ‡ãƒ¼ã‚¿ã®æ™‚é–“ã‚‚ä¿®æ­£ï¼ˆ19:00 UTC â†’ 10:00 UTCï¼‰
                activeResponses.forEach(response => {
                    if (response.available_dates && Array.isArray(response.available_dates)) {
                        response.available_dates = response.available_dates.map(dateStr => {
                            const date = new Date(dateStr);
                            if (date.getUTCHours() === 19) {
                                date.setUTCHours(10);
                                return date.toISOString();
                            }
                            return dateStr;
                        });
                    }
                });
                console.log('ğŸ”§ å›ç­”ãƒ‡ãƒ¼ã‚¿ã®æ™‚é–“ä¿®æ­£å®Œäº†');
                
                currentResponses = activeResponses;
                console.log('èª­ã¿è¾¼ã‚“ã å›ç­”:', activeResponses);
                
                // è¡¨ç¤ºåˆ¶é™ãƒ•ãƒ©ã‚°ã‚’ãƒªã‚»ãƒƒãƒˆ
                showingAll = false;
                
                displayResponses(activeResponses);
                
            } catch (error) {
                console.error('å›ç­”èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
                console.error('ã‚¨ãƒ©ãƒ¼è©³ç´°:', error.message);
                console.error('ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹:', error.stack);
                
                // ã‚¨ãƒ©ãƒ¼ã‚’ã‚ˆã‚Šè©³ã—ãèª¿æŸ»
                if (error.name) console.error('ã‚¨ãƒ©ãƒ¼å:', error.name);
                if (error.code) console.error('ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰:', error.code);
                
                throw error;
            }
        }
        
        // ã‚¤ãƒ™ãƒ³ãƒˆæƒ…å ±ã‚’è¡¨ç¤º
        function displayEvent(event) {
            console.log('ğŸ™ ã‚¤ãƒ™ãƒ³ãƒˆæƒ…å ±è¡¨ç¤ºé–‹å§‹:', event);
            console.log('ğŸ™ deadlineç¢ºèª:', event.deadline);
            
            // ã‚¤ãƒ™ãƒ³ãƒˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æ¤œè¨¼
            if (!event) {
                console.error('âŒ ã‚¤ãƒ™ãƒ³ãƒˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒnullã¾ãŸã¯undefinedã§ã™');
                const titleElement = document.getElementById('event-title');
                if (titleElement) {
                    titleElement.textContent = 'ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ';
                    titleElement.style.color = '#ef4444';
                }
                return;
            }
            
            // ã‚¿ã‚¤ãƒˆãƒ«
            const titleElement = document.getElementById('event-title');
            if (titleElement) {
                const title = event.title || 'ã‚¤ãƒ™ãƒ³ãƒˆåãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“';
                titleElement.textContent = title;
                titleElement.style.color = ''; // ã‚¨ãƒ©ãƒ¼è‰²ã‚’ãƒªã‚»ãƒƒãƒˆ
                console.log('âœ… ã‚¿ã‚¤ãƒˆãƒ«ã‚’è¡¨ç¤º:', title);
            } else {
                console.error('âŒ event-titleè¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
            }
            
            // èª¬æ˜ï¼ˆè¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã®ã¿è¡¨ç¤ºï¼‰
            const descElement = document.getElementById('event-description');
            if (descElement) {
                if (event.description && event.description.trim() !== '') {
                    descElement.textContent = event.description;
                    descElement.style.display = 'block';
                } else {
                    descElement.style.display = 'none';
                }
            }
            
            // é–‹å‚¬å ´æ‰€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆè¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã®ã¿è¡¨ç¤ºï¼‰
            const locationSection = document.getElementById('location-section');
            const locationText = document.getElementById('location-text');
            if (locationSection && locationText) {
                if (event.location && event.location.trim() !== '') {
                    locationText.textContent = event.location;
                    locationSection.style.display = 'block';
                } else {
                    locationSection.style.display = 'none';
                }
            }
            
            // äºˆç®—ã‚«ãƒ¼ãƒ‰ï¼ˆè¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã®ã¿è¡¨ç¤ºï¼‰
            const budgetCard = document.getElementById('budget-card');
            const budgetText = document.getElementById('budget-text');
            if (budgetCard && budgetText) {
                if (event.budget && event.budget > 0) {
                    budgetText.textContent = `${event.budget.toLocaleString()}å††`;
                    budgetCard.style.display = 'block';
                } else {
                    budgetCard.style.display = 'none';
                }
            }
            
            // å›ç­”ç· åˆ‡ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆè¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã®ã¿è¡¨ç¤ºï¼‰
            const deadlineSection = document.getElementById('deadline-section');
            const deadlineText = document.getElementById('deadline-text');
            if (deadlineSection && deadlineText) {
                console.log('ğŸ™ deadlineå‡¦ç†é–‹å§‹:', {
                    deadline: event.deadline,
                    type: typeof event.deadline,
                    hasDeadline: !!event.deadline
                });
                
                if (event.deadline) {
                    const deadlineDate = new Date(event.deadline);
                    console.log('ğŸ™ deadlineæ—¥ä»˜å¤‰æ›:', deadlineDate);
                    
                    const options = { 
                        year: 'numeric', 
                        month: 'long', 
                        day: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit'
                    };
                    const formattedDate = deadlineDate.toLocaleDateString('ja-JP', options);
                    console.log('ğŸ™ ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ¸ˆã¿æ—¥ä»˜:', formattedDate);
                    
                    deadlineText.textContent = formattedDate;
                    deadlineSection.style.display = 'block';
                    console.log('ğŸ™ deadlineè¡¨ç¤ºå®Œäº†');
                } else {
                    deadlineSection.style.display = 'none';
                    console.log('ğŸ™ deadlineæœªè¨­å®šã®ãŸã‚éè¡¨ç¤º');
                }
            } else {
                console.warn('âš ï¸ deadlineSection ã¾ãŸã¯ deadlineText ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
            }
            
            
            // ã‚«ãƒ¼ãƒ‰ã®æ•°ã«å¿œã˜ã¦ã‚°ãƒªãƒƒãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’èª¿æ•´
            updateGridLayout();
            
            // å€™è£œæ—¥æ™‚ã‚’å‹•çš„ã«ç”Ÿæˆ
            if (event.candidate_dates && Array.isArray(event.candidate_dates)) {
                console.log('ğŸ™ å€™è£œæ—¥æ™‚:', event.candidate_dates);
                console.log('ğŸ™ å€™è£œæ—¥æ™‚ã®æ•°:', event.candidate_dates.length);
                event.candidate_dates.forEach((date, index) => {
                    console.log(`ğŸ™ æ—¥ä»˜${index + 1}:`, date);
                });
                generateDateHeaders(event.candidate_dates);
            } else {
                console.warn('âš ï¸ å€™è£œæ—¥æ™‚ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“:', event.candidate_dates);
            }
            
            console.log('ğŸ™ ã‚¤ãƒ™ãƒ³ãƒˆæƒ…å ±è¡¨ç¤ºå®Œäº†');
        }
        
        // ã‚«ãƒ¼ãƒ‰ã®æ•°ã«å¿œã˜ã¦ã‚°ãƒªãƒƒãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’èª¿æ•´
        function updateGridLayout() {
            const cardsContainer = document.getElementById('event-info-cards');
            if (!cardsContainer) return;
            
            const visibleCards = cardsContainer.querySelectorAll('[id$="-card"][style*="block"], [id$="-card"]:not([style*="none"])');
            const cardCount = Array.from(visibleCards).filter(card => 
                card.style.display !== 'none'
            ).length;
            
            // ã‚«ãƒ¼ãƒ‰ã®æ•°ã«å¿œã˜ã¦ã‚°ãƒªãƒƒãƒ‰ã‚¯ãƒ©ã‚¹ã‚’èª¿æ•´
            cardsContainer.className = 'grid gap-6 ' + 
                (cardCount === 1 ? 'grid-cols-1 max-w-md mx-auto' :
                 cardCount === 2 ? 'grid-cols-1 md:grid-cols-2 max-w-2xl mx-auto' :
                 'grid-cols-1 md:grid-cols-3');
        }
        
        // å‚åŠ äººæ•°ã‚’è¨ˆç®—ã™ã‚‹é–¢æ•°
        function calculateParticipantCount(dateStr) {
            console.log('ğŸ” =====================');
            console.log('ğŸ” å‚åŠ è€…æ•°è¨ˆç®—é–‹å§‹:', dateStr);
            console.log('ğŸ” =====================');
            
            if (!window.responses || !Array.isArray(window.responses)) {
                console.warn('âš ï¸ window.responsesãŒå­˜åœ¨ã—ã¾ã›ã‚“');
                return { attending: 0, maybe: 0, notAttending: 0 };
            }
            
            console.log('ğŸ” å›ç­”ãƒ‡ãƒ¼ã‚¿æ•°:', window.responses.length);
            console.log('ğŸ” å…¨å‚åŠ è€…ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ä¸€è¦§:');
            window.responses.forEach((response, index) => {
                console.log(`  ${index + 1}. ${response.participant_name}: ${response.status} | available_dates:`, response.available_dates);
            });
            
            let attending = 0;
            let maybe = 0;
            let notAttending = 0;
            
            console.log('ğŸ” =====================');
            console.log(`ğŸ” ${dateStr} ã®è©³ç´°è¨ˆç®—é–‹å§‹`);
            console.log('ğŸ” =====================');
            
            window.responses.forEach((response, index) => {
                console.log(`ğŸ” ${response.participant_name}: status=${response.status}, available_dates=`, response.available_dates);
                
                // æ—¥ä»˜ã®æ¯”è¼ƒã‚’æ”¹å–„ï¼ˆç•°ãªã‚‹å½¢å¼ã«å¯¾å¿œï¼‰
                const isDateAvailable = response.available_dates && response.available_dates.some(availableDate => {
                    // ä¸¡æ–¹ã‚’Dateã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›ã—ã¦æ¯”è¼ƒ
                    const date1 = new Date(dateStr);
                    const date2 = new Date(availableDate);
                    const match = date1.getTime() === date2.getTime();
                    return match;
                });
                console.log(`ğŸ” ${response.participant_name}: æ—¥ä»˜åˆ©ç”¨å¯èƒ½ = ${isDateAvailable}`);
                
                // è¡¨ã®è¡¨ç¤ºãƒ­ã‚¸ãƒƒã‚¯ã¨åŒã˜åˆ¤å®šã‚’ä½¿ç”¨
                const tableStatus = getStatusForDate(response, dateStr);
                
                if (tableStatus === 'attending') {
                    attending++;
                    console.log(`âœ… ${response.participant_name}: å‚åŠ  (+1) åˆè¨ˆ=${attending}`);
                } else if (tableStatus === 'maybe') {
                    maybe++;
                    console.log(`âš ï¸ ${response.participant_name}: æœªå®š (+1) åˆè¨ˆ=${maybe}`);
                } else {
                    // 'notAttending' ã¾ãŸã¯ ãã®ä»–
                    notAttending++;
                    console.log(`âŒ ${response.participant_name}: ä¸å‚åŠ  (+1) åˆè¨ˆ=${notAttending}`);
                }
            });
            
            console.log('ğŸ” =====================');
            console.log(`ğŸ“Š ${dateStr} æœ€çµ‚çµæœ:`);
            console.log(`   å‚åŠ : ${attending}å`);
            console.log(`   æœªå®š: ${maybe}å`);
            console.log(`   ä¸å‚åŠ : ${notAttending}å`);
            console.log(`   ç·è¨ˆ: ${attending + maybe + notAttending}å`);
            console.log('ğŸ” =====================');
            
            return { attending, maybe, notAttending };
        }
        
        // å‚åŠ äººæ•°ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’å–å¾—
        function getParticipantCountStyle(participantCount) {
            const total = participantCount.attending + participantCount.maybe;
            
            if (total >= 5) {
                return 'bg-emerald-100 text-emerald-700 border border-emerald-200';
            } else if (total >= 3) {
                return 'bg-amber-100 text-amber-700 border border-amber-200';
            } else if (total >= 1) {
                return 'bg-blue-100 text-blue-700 border border-blue-200';
            } else {
                return 'bg-stone-100 text-stone-600 border border-stone-200';
            }
        }
        
        // æ—¥ç¨‹ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’å‹•çš„ç”Ÿæˆ
        function generateDateHeaders(dates) {
            console.log('ğŸ—“ï¸ æ—¥ç¨‹ãƒ˜ãƒƒãƒ€ãƒ¼ç”Ÿæˆé–‹å§‹:', dates);
            console.log('ğŸ—“ï¸ æ—¥ä»˜ã®æ•°:', dates ? dates.length : 0);
            
            // é‡è¤‡ãƒã‚§ãƒƒã‚¯ã¨å¼·åˆ¶é™¤å»
            if (dates && Array.isArray(dates)) {
                const uniqueDates = [...new Set(dates)];
                console.log('ğŸ—“ï¸ é‡è¤‡é™¤å»å¾Œ:', uniqueDates);
                if (dates.length !== uniqueDates.length) {
                    console.warn('âš ï¸ é‡è¤‡ã™ã‚‹æ—¥ä»˜ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸï¼', dates);
                    console.log('ğŸ”§ é‡è¤‡ã‚’é™¤å»ã—ã¦ç¶šè¡Œã—ã¾ã™');
                    dates = uniqueDates; // é‡è¤‡ã‚’é™¤å»ã—ãŸé…åˆ—ã‚’ä½¿ç”¨
                }
            }
            
            // responsesãŒã¾ã èª­ã¿è¾¼ã¾ã‚Œã¦ã„ãªã„å ´åˆã¯ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã¨ã—ã¦åˆæœŸåŒ–
            if (!window.responses) {
                window.responses = [];
            }
            
            // å›ç­”ä¸€è¦§ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®theadã‚’å–å¾—
            const sections = document.querySelectorAll('section');
            let detailTableHeader = null;
            
            sections.forEach(section => {
                const h2 = section.querySelector('h2');
                if (h2 && h2.textContent.includes('å›ç­”ä¸€è¦§')) {
                    detailTableHeader = section.querySelector('thead tr');
                    console.log('ğŸ—“ï¸ å›ç­”ä¸€è¦§ã®headerç™ºè¦‹');
                }
            });
            
            if (!detailTableHeader) {
                console.error('âŒ å›ç­”ä¸€è¦§ã®headerãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                return;
            }
            
            // æ–°ã—ã„ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’å®Œå…¨ã«ä½œã‚Šç›´ã™
            detailTableHeader.innerHTML = '';
            
            // å‚åŠ è€…ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆå›ºå®šå¹…ï¼‰
            const participantHeader = document.createElement('th');
            participantHeader.className = 'text-left py-3 px-6 font-medium text-stone-700 text-sm uppercase tracking-wider w-80';
            participantHeader.textContent = 'å‚åŠ è€…';
            detailTableHeader.appendChild(participantHeader);
            
            // æ—¥ç¨‹ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’è¿½åŠ ï¼ˆå‚åŠ äººæ•°ä»˜ãï¼‰
            dates.forEach(dateStr => {
                const date = new Date(dateStr);
                const th = document.createElement('th');
                th.className = 'py-3 px-3 text-center text-sm font-medium text-stone-700 uppercase tracking-wider';
                
                // ã“ã®æ—¥ç¨‹ã®å‚åŠ å¯èƒ½äººæ•°ã‚’è¨ˆç®—
                const participantCount = calculateParticipantCount(dateStr);
                
                th.innerHTML = `
                    <div class="space-y-1">
                        <div class="text-base font-semibold text-stone-900">${formatDateShort(date)}</div>
                        <div class="text-xs text-stone-600 flex items-center justify-center">
                            <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                            ${formatTimeRange(date)}
                        </div>
                        <div class="mt-2 space-y-1 flex flex-col items-center">
                            <div class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium border ${participantCount.attending === 0 ? 'opacity-50' : ''}" style="background-color: #F0FDF4; color: #0F7B0F; border-color: #BBF7D0;">
                                <span class="mr-1">â—‹</span>
                                <span>${participantCount.attending}å</span>
                            </div>
                            <div class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium border ${participantCount.maybe === 0 ? 'opacity-50' : ''}" style="background-color: #FFFBEB; color: #D97706; border-color: #FED7AA;">
                                <span class="mr-1">?</span>
                                <span>${participantCount.maybe}å</span>
                            </div>
                            <div class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium border ${participantCount.notAttending === 0 ? 'opacity-50' : ''}" style="background-color: #F8F9FA; color: #6B7280; border-color: #E5E7EB;">
                                <span class="mr-1">Ã—</span>
                                <span>${participantCount.notAttending}å</span>
                            </div>
                        </div>
                    </div>
                `;
                detailTableHeader.appendChild(th);
            });
            
            // ãƒ˜ãƒƒãƒ€ãƒ¼ç”Ÿæˆå®Œäº†
            
            // ãƒ˜ãƒƒãƒ€ãƒ¼ç”Ÿæˆå®Œäº†
            

            
            console.log('ğŸ—“ï¸ æ—¥ç¨‹ãƒ˜ãƒƒãƒ€ãƒ¼ç”Ÿæˆå®Œäº†');
        }
        
        // å›ç­”ã‚’è¡¨ç¤º
        function displayResponses(responses) {
            // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã¨ã—ã¦ä¿å­˜ï¼ˆå‚åŠ äººæ•°è¨ˆç®—ã§ä½¿ç”¨ï¼‰
            window.responses = responses || [];
            // ã‚ˆã‚Šç¢ºå®Ÿãªã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼ï¼šå›ç­”ä¸€è¦§ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®tbodyã‚’å–å¾—
            const sections = document.querySelectorAll('section');
            let detailTableBody = null;
            
            sections.forEach(section => {
                const h2 = section.querySelector('h2');
                if (h2 && h2.textContent.includes('å›ç­”ä¸€è¦§')) {
                    detailTableBody = section.querySelector('tbody');
                    console.log('âœ… å›ç­”ä¸€è¦§ã‚»ã‚¯ã‚·ãƒ§ãƒ³ç™ºè¦‹:', h2.textContent);
                }
            });
            
            if (!detailTableBody || !currentEvent) {
                console.error('âŒ å›ç­”ä¸€è¦§ã®tbodyãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                console.log('ã‚»ã‚¯ã‚·ãƒ§ãƒ³æ•°:', sections.length);
                sections.forEach((section, index) => {
                    const h2 = section.querySelector('h2');
                    console.log(`ã‚»ã‚¯ã‚·ãƒ§ãƒ³${index}:`, h2 ? h2.textContent : 'h2ãªã—');
                });
                return;
            }
            
            console.log('âœ… å›ç­”ä¸€è¦§tbodyå–å¾—æˆåŠŸã€responses:', responses ? responses.length : 0, 'ä»¶');
            
            detailTableBody.innerHTML = '';
            
            if (!responses || responses.length === 0) {
                detailTableBody.innerHTML = `
                    <tr>
                        <td colspan="100%" class="py-12 text-center text-gray-500">
                            ã¾ã å›ç­”ãŒã‚ã‚Šã¾ã›ã‚“
                        </td>
                    </tr>
                `;
                // ã€Œã‚‚ã£ã¨è¡¨ç¤ºã€ãƒœã‚¿ãƒ³ã‚’éè¡¨ç¤º
                const showMoreSection = document.getElementById('show-more-section');
                if (showMoreSection) {
                    showMoreSection.style.display = 'none';
                }
                return;
            }
            
            // è¡¨ç¤ºã™ã‚‹å›ç­”ã‚’æ±ºå®š
            const displayResponses = showingAll ? responses : responses.slice(0, displayLimit);
            const remainingCount = responses.length - displayLimit;
            
            displayResponses.forEach((response, index) => {
                const row = createResponseRow(response, index);
                detailTableBody.appendChild(row);
            });
            
            // ã€Œã‚‚ã£ã¨è¡¨ç¤ºã€ãƒœã‚¿ãƒ³ã®è¡¨ç¤ºåˆ¶å¾¡
            const showMoreSection = document.getElementById('show-more-section');
            const showMoreText = document.getElementById('show-more-text');
            
            if (showMoreSection && showMoreText) {
                if (showingAll || responses.length <= displayLimit) {
                    // å…¨ä»¶è¡¨ç¤ºä¸­ã€ã¾ãŸã¯ä»¶æ•°ãŒå°‘ãªã„å ´åˆã¯éè¡¨ç¤º
                    showMoreSection.style.display = 'none';
                } else {
                    // æ®‹ã‚ŠãŒã‚ã‚‹å ´åˆã¯è¡¨ç¤º
                    showMoreSection.style.display = 'block';
                    showMoreText.textContent = `æ®‹ã‚Š${remainingCount}åã®å›ç­”ã‚’è¡¨ç¤º`;
                }
            }
            
            // ã‚µãƒãƒªãƒ¼æƒ…å ±ã‚’æ›´æ–°
            // updateSummary(responses);
            
            // æ—¥ç¨‹åˆ¥å‚åŠ çŠ¶æ³ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ›´æ–°
            updateScheduleTable(responses);
            
            // æ—¥ç¨‹åˆ¥å›ç­”çŠ¶æ³ã‚°ãƒ©ãƒ•ã‚’ä½œæˆ
            createScheduleChart(responses);
            
            // å‚åŠ äººæ•°ãŒæ›´æ–°ã•ã‚ŒãŸã®ã§ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’å†ç”Ÿæˆ
            if (currentEvent && currentEvent.candidate_dates) {
                generateDateHeaders(currentEvent.candidate_dates);
            }
            
            console.log('ğŸ™ å›ç­”è¡¨ç¤ºå®Œäº†:', displayResponses.length, 'ä»¶ (å…¨', responses.length, 'ä»¶ä¸­)');
        }
        
        // å›ç­”è¡Œã‚’ä½œæˆ
        function createResponseRow(response, index = 0) {
            const tr = document.createElement('tr');
            tr.className = 'table-row';
            tr.style.borderBottom = '1px solid #E9E5E0';
            tr.style.background = index % 2 === 0 ? '#FFFFFF' : '#FAFAFA';
            
            // å‚åŠ è€…åï¼ˆã‚¯ãƒªãƒƒã‚¯å¯èƒ½ãªãƒªãƒ³ã‚¯ã€å›ºå®šå¹…ï¼‰
            const nameCell = document.createElement('td');
            nameCell.className = 'py-4 px-6 w-80';
            nameCell.style.borderRight = '1px solid #E9E5E0';
            nameCell.innerHTML = `
                <div class="flex items-center space-x-3 cursor-pointer hover:bg-stone-50 rounded-lg p-2 transition-all duration-200" onclick="editResponse('${response.id}')">
                    <div class="w-10 h-10 bg-stone-600 rounded-full flex items-center justify-center shadow-sm">
                        <span class="text-white font-semibold text-sm">${response.participant_name.charAt(0)}</span>
                    </div>
                    <div>
                        <div class="text-base font-semibold text-stone-900 hover:text-stone-700 transition-colors duration-200">${response.participant_name}</div>
                        ${response.comment ? `
                            <div class="text-sm text-gray-500 max-w-xs relative group">
                                <span class="cursor-help">${
                                    response.comment.length > 10 ? response.comment.substring(0, 10) + '...' : response.comment
                                }</span>
                                ${response.comment.length > 10 ? `
                                    <div class="absolute bottom-full left-0 mb-2 px-3 py-2 bg-gray-800 text-white text-xs rounded-lg shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-150 pointer-events-none whitespace-nowrap z-50 transform -translate-y-1 group-hover:translate-y-0">
                                        ${response.comment}
                                        <div class="absolute top-full left-4 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-800"></div>
                                    </div>
                                ` : ''}
                            </div>
                        ` : ''}
                    </div>
                    <div class="ml-2">
                        <svg class="w-4 h-4 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                        </svg>
                    </div>
                </div>
            `;
            tr.appendChild(nameCell);
            
            // å„æ—¥ç¨‹ã®å›ç­”
            if (currentEvent && currentEvent.candidate_dates && Array.isArray(currentEvent.candidate_dates)) {
                currentEvent.candidate_dates.forEach(dateStr => {
                    const cell = document.createElement('td');
                    cell.className = 'py-4 px-3 text-center';
                    cell.style.borderRight = '1px solid #E9E5E0';
                    
                    const status = getStatusForDate(response, dateStr);
                    cell.innerHTML = createStatusBadge(status);
                    
                    tr.appendChild(cell);
                });
            } else {
                console.warn('âš ï¸ currentEvent.candidate_datesãŒå­˜åœ¨ã—ã¾ã›ã‚“:', currentEvent);
                // æœ€ä½1ã¤ã®æ—¥ç¨‹ã‚»ãƒ«ã‚’ä½œæˆ
                const cell = document.createElement('td');
            cell.className = 'py-4 px-3 text-center';
                cell.innerHTML = createStatusBadge('notAttending');
                tr.appendChild(cell);
            }
            
            // è¡Œç”Ÿæˆå®Œäº†
            
            // è¡Œç”Ÿæˆå®Œäº†
            
            return tr;
        }
        
        // æŒ‡å®šæ—¥æ™‚ã®å›ç­”ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’å–å¾—
        function getStatusForDate(response, dateStr) {
            const targetDate = new Date(dateStr);
            
            // ã¾ãšä¸å‚åŠ ã®å ´åˆã¯å³åº§ã«è¿”ã™
            if (response.status === 'not_attending') {
                return 'notAttending';
            }
            
            // available_datesã‚’ãƒã‚§ãƒƒã‚¯
            if (response.available_dates && Array.isArray(response.available_dates)) {
                for (const availableDate of response.available_dates) {
                    if (isSameDay(new Date(availableDate), targetDate)) {
                        // æ—¥ä»˜ãŒåˆ©ç”¨å¯èƒ½ãªå ´åˆã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã«å¿œã˜ã¦è¿”ã™
                        if (response.status === 'attending') {
                            return 'attending';
                        } else if (response.status === 'undecided' || response.status === 'maybe') {
                            return 'maybe';
                        }
                        return 'attending'; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ
                    }
                }
            }
            
            // å…¨ä½“ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‹ã‚‰æœªå®šã‹ã©ã†ã‹ã‚’åˆ¤å®š
            if (response.status === 'undecided') {
                return 'maybe';
            }
            
            return 'notAttending';
        }
        
        // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒƒã‚¸ã‚’ä½œæˆï¼ˆãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ã‚¢ã‚¤ã‚³ãƒ³ï¼‰
        function createStatusBadge(status) {
            const configs = {
                attending: {
                    icon: `<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <circle cx="12" cy="12" r="9" stroke-width="2.5"/>
                    </svg>`,
                    classes: 'border border-stone-200',
                    style: 'background-color: #F0FDF4; color: #0F7B0F; border-color: #BBF7D0;'
                },
                maybe: {
                    icon: `<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01"/>
                    </svg>`,
                    classes: 'border border-stone-200',
                    style: 'background-color: #FFFBEB; color: #D97706; border-color: #FED7AA;'
                },
                notAttending: {
                    icon: `<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M6 18L18 6M6 6l12 12"/>
                    </svg>`,
                    classes: 'border border-stone-200',
                    style: 'background-color: #F8F9FA; color: #6B7280; border-color: #E5E7EB;'
                }
            };
            
            const config = configs[status] || configs.notAttending;
            
            return `
                <span class="status-badge inline-flex items-center justify-center w-8 h-8 rounded-full ${config.classes} border shadow-sm" style="${config.style}">
                    ${config.icon}
                </span>
            `;
        }
        
        // æ—¥ä»˜ãŒåŒã˜æ—¥ã‹ãƒã‚§ãƒƒã‚¯
        function isSameDay(date1, date2) {
            return date1.getFullYear() === date2.getFullYear() &&
                   date1.getMonth() === date2.getMonth() &&
                   date1.getDate() === date2.getDate();
        }
        
        // æ—¥ç¨‹åˆ¥å‚åŠ çŠ¶æ³ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ›´æ–°
        function updateScheduleTable(responses) {
            if (!currentEvent || !currentEvent.candidate_dates) return;
            
            // é‡è¤‡é™¤å»ã‚’å¼·åˆ¶å®Ÿè¡Œ
            const originalDates = currentEvent.candidate_dates;
            const uniqueDates = [...new Set(originalDates)];
            console.log('ğŸ”§ é‡è¤‡é™¤å» - å…ƒ:', originalDates.length, 'å€‹', 'é™¤å»å¾Œ:', uniqueDates.length, 'å€‹');
            
            if (originalDates.length !== uniqueDates.length) {
                console.warn('âš ï¸ é‡è¤‡ã‚’ç™ºè¦‹ã—ã¦é™¤å»ã—ã¾ã—ãŸ:', originalDates);
                console.log('âœ… é™¤å»å¾Œã®æ—¥ä»˜:', uniqueDates);
                currentEvent.candidate_dates = uniqueDates;
            }
            
            // ã‚ˆã‚Šç¢ºå®Ÿãªã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼ï¼šæ—¥ç¨‹åˆ¥å‚åŠ çŠ¶æ³ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®tbodyã‚’å–å¾—
            const sections = document.querySelectorAll('section');
            let scheduleTableBody = null;
            
            sections.forEach(section => {
                const h2 = section.querySelector('h2');
                if (h2 && h2.textContent.includes('æ—¥ç¨‹åˆ¥å›ç­”çŠ¶æ³')) {
                    scheduleTableBody = section.querySelector('tbody');
                }
            });
            
            if (!scheduleTableBody) return;
            
            scheduleTableBody.innerHTML = '';
            
            // å„å€™è£œæ—¥æ™‚ã®çµ±è¨ˆã‚’è¨ˆç®—
            console.log('ğŸ“Š çµ±è¨ˆè¨ˆç®—é–‹å§‹ - candidate_dates:', currentEvent.candidate_dates);
            const dateStats = currentEvent.candidate_dates.map((dateStr, index) => {
                console.log(`ğŸ“Š å‡¦ç†ä¸­ã®æ—¥ä»˜${index + 1}:`, dateStr);
                const date = new Date(dateStr);
                const stats = {
                    date: date,
                    dateStr: dateStr,
                    attending: 0,
                    maybe: 0,
                    notAttending: 0
                };
                
                responses.forEach(response => {
                    // è¡¨ã®è¡¨ç¤ºãƒ­ã‚¸ãƒƒã‚¯ã¨åŒã˜åˆ¤å®šã‚’ä½¿ç”¨
                    const tableStatus = getStatusForDate(response, dateStr);
                    
                    if (tableStatus === 'attending') {
                        stats.attending++;
                    } else if (tableStatus === 'maybe') {
                        stats.maybe++;
                    } else {
                        stats.notAttending++;
                    }
                });
                
                stats.total = stats.attending + stats.maybe + stats.notAttending;
                
                return stats;
            });
            
            // äººæ°—é †ã§ã‚½ãƒ¼ãƒˆ
            dateStats.sort((a, b) => b.attending - a.attending);
            
            // ãƒ†ãƒ¼ãƒ–ãƒ«è¡Œã‚’ç”Ÿæˆ
            console.log('ğŸ“‹ ãƒ†ãƒ¼ãƒ–ãƒ«è¡Œç”Ÿæˆé–‹å§‹ - dateStats:', dateStats);
            dateStats.forEach((stats, index) => {
                console.log(`ğŸ“‹ è¡Œ${index + 1}ç”Ÿæˆ:`, stats.dateStr, formatDateLong(stats.date));
                const row = createScheduleTableRow(stats, index);
                scheduleTableBody.appendChild(row);
            });
        }
        
        // æ—¥ç¨‹åˆ¥å‚åŠ çŠ¶æ³ãƒ†ãƒ¼ãƒ–ãƒ«ã®è¡Œã‚’ä½œæˆ
        function createScheduleTableRow(stats, index) {
            const tr = document.createElement('tr');
            tr.className = 'table-row';
            tr.style.borderBottom = '1px solid #E9E5E0';
            tr.style.background = index % 2 === 0 ? '#FFFFFF' : '#FAFAFA';
            
            // è©•ä¾¡ã‚’æ±ºå®š
            let evaluation = { 
                icon: `<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>`, 
                text: 'æ¤œè¨ä¸­', 
                color: 'stone' 
            };
            if (index === 0 && stats.attending >= 3) {
                evaluation = { 
                    icon: `<svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                    </svg>`, 
                    text: 'æœ€æœ‰åŠ›', 
                    color: 'emerald' 
                };
            } else if (index <= 1 && stats.attending >= 2) {
                evaluation = { 
                    icon: `<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.06L7 20m7-10V5a2 2 0 00-2-2h-.095c-.5 0-.905.405-.905.905 0 .714-.211 1.412-.608 2.006L7 11v9m7-10h-2M7 20H5a2 2 0 01-2-2v-6a2 2 0 012-2h2.5"/>
                    </svg>`, 
                    text: 'å€™è£œ', 
                    color: 'amber' 
                };
            }
            
            // æ›œæ—¥ã‚¢ã‚¤ã‚³ãƒ³ã®è‰²ã‚’æ±ºå®šï¼ˆåœŸæ—¥ã®ã¿è½ã¡ç€ã„ãŸèµ¤è‰²ï¼‰
            const dayOfWeek = stats.date.getDay();
            const weekdayColor = (dayOfWeek === 0 || dayOfWeek === 6) ? 'red' : 'stone';
            const weekdays = ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'];
            const weekday = weekdays[stats.date.getDay()];
            
            tr.innerHTML = `
                <td class="py-4 px-6" style="border-right: 1px solid #E9E5E0;">
                    <div class="flex items-center space-x-4">
                        <div class="w-10 h-10 bg-${weekdayColor}-600 rounded-lg flex items-center justify-center">
                            <span class="text-white font-semibold text-sm">${weekday}</span>
                        </div>
                        <div>
                            <div class="text-lg font-semibold text-stone-900">${formatDateLong(stats.date)}</div>
                            <div class="text-sm text-stone-600 flex items-center mt-1">
                                <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                </svg>
                                ${formatTimeRange(stats.date)}
                            </div>
                        </div>
                    </div>
                </td>
                <td class="py-4 px-4 text-center" style="border-right: 1px solid #E9E5E0;">
                    <div class="flex items-center justify-center space-x-1">
                        <span class="text-lg" style="color: #0F7B0F;">â—‹</span>
                        <span class="text-sm font-medium text-stone-700">${stats.attending}å</span>
                    </div>
                </td>
                <td class="py-4 px-4 text-center" style="border-right: 1px solid #E9E5E0;">
                    <div class="flex items-center justify-center space-x-1">
                        <span class="text-lg" style="color: #D97706;">?</span>
                        <span class="text-sm font-medium text-stone-700">${stats.maybe}å</span>
                    </div>
                </td>
                <td class="py-4 px-4 text-center" style="border-right: 1px solid #E9E5E0;">
                    <div class="flex items-center justify-center space-x-1">
                        <span class="text-lg" style="color: #6B7280;">Ã—</span>
                        <span class="text-sm font-medium text-stone-700">${stats.notAttending}å</span>
                    </div>
                </td>
                <td class="py-4 px-4 text-center" style="border-right: 1px solid #E9E5E0;">
                    <span class="text-sm font-semibold text-stone-900">${stats.total}å</span>
                </td>
                <td class="py-4 px-6 text-center">
                    <div class="flex items-center justify-center space-x-2">
                        <span class="text-${evaluation.color}-600">${evaluation.icon}</span>
                        <span class="text-sm font-semibold text-${evaluation.color}-600">${evaluation.text}</span>
                    </div>
                </td>
            `;
            
            return tr;
        }
        
        // æ—¥ä»˜ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆé•·å½¢å¼ï¼‰- UTCæ—¥ä»˜ã‚’æ­£ç¢ºã«è¡¨ç¤º
        function formatDateLong(date) {
            const weekdays = ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'];
            // UTCãƒ™ãƒ¼ã‚¹ã§æ—¥ä»˜ã‚’å–å¾—ï¼ˆã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³å¤‰æ›ã®å½±éŸ¿ã‚’é¿ã‘ã‚‹ï¼‰
            const month = date.getUTCMonth() + 1;
            const day = date.getUTCDate();
            const weekday = weekdays[date.getUTCDay()];
            return `${month}æœˆ${day}æ—¥ï¼ˆ${weekday}ï¼‰`;
        }
        
        // æ™‚é–“ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆé–‹å§‹æ™‚é–“ã®ã¿ï¼‰
        function formatTimeRange(date) {
            // ãƒ­ãƒ¼ã‚«ãƒ«æ™‚é–“ã§è¡¨ç¤ºï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ãŒè‡ªå‹•çš„ã«ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³å¤‰æ›ï¼‰
            const startHour = date.getHours();
            const startMinute = date.getMinutes();
            const startTime = `${startHour.toString().padStart(2, '0')}:${startMinute.toString().padStart(2, '0')}`;
            
            return `${startTime}ã€œ`;
        }
        
        // æ—¥ä»˜ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆé–¢æ•°
        function formatDateShort(date) {
            const weekdays = ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'];
            // UTCãƒ™ãƒ¼ã‚¹ã§æ—¥ä»˜ã‚’å–å¾—ï¼ˆã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³å¤‰æ›ã®å½±éŸ¿ã‚’é¿ã‘ã‚‹ï¼‰
            const month = date.getUTCMonth() + 1;
            const day = date.getUTCDate();
            const weekday = weekdays[date.getUTCDay()];
            return `${month}/${day}(${weekday})`;
        }
        
        function formatTimeShort(date) {
            const hours = date.getHours().toString().padStart(2, '0');
            const minutes = date.getMinutes().toString().padStart(2, '0');
            return `${hours}:${minutes}`;
        }
        
        function formatDateTimeShort(date) {
            const month = date.getMonth() + 1;
            const day = date.getDate();
            const hours = date.getHours().toString().padStart(2, '0');
            const minutes = date.getMinutes().toString().padStart(2, '0');
            return `${month}/${day} ${hours}:${minutes}`;
        }
        
        // å›ç­”ã‚’ç·¨é›†
        function editResponse(responseId) {
            // å›ç­”ãƒ•ã‚©ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã«é·ç§»ï¼ˆç·¨é›†ãƒ¢ãƒ¼ãƒ‰ï¼‰
            const urlParams = new URLSearchParams();
            urlParams.set('id', currentEventId);
            urlParams.set('edit', responseId);
            window.location.href = `response-form.html?${urlParams.toString()}`;
        }
        
        // æ–°è¦å›ç­”ãƒ•ã‚©ãƒ¼ãƒ ã«é·ç§»
        function goToResponseForm() {
            console.log('ğŸ”„ å›ç­”ãƒ•ã‚©ãƒ¼ãƒ ã¸ã®é·ç§»ã‚’é–‹å§‹');
            console.log('- currentEventId:', currentEventId);
            
            if (!currentEventId) {
                console.error('âŒ ã‚¤ãƒ™ãƒ³ãƒˆIDãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“');
                alert('ã‚¨ãƒ©ãƒ¼: ã‚¤ãƒ™ãƒ³ãƒˆæƒ…å ±ãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã›ã‚“ã€‚ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãã ã•ã„ã€‚');
                return;
            }
            
            // å›ç­”ãƒ•ã‚©ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã«é·ç§»ï¼ˆæ–°è¦ãƒ¢ãƒ¼ãƒ‰ï¼‰
            const urlParams = new URLSearchParams();
            urlParams.set('id', currentEventId);
            const targetUrl = `response-form.html?${urlParams.toString()}`;
            
            console.log('- é·ç§»å…ˆURL:', targetUrl);
            console.log('âœ… é·ç§»ã‚’å®Ÿè¡Œã—ã¾ã™');
            
            window.location.href = targetUrl;
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆURLã‚’ã‚³ãƒ”ãƒ¼
        async function copyEventUrl() {
            const currentUrl = window.location.href;
            const copyBtn = document.getElementById('copyUrlBtn');
            const copyText = document.getElementById('copyText');
            const copyIcon = document.getElementById('copyIcon');
            
            try {
                await navigator.clipboard.writeText(currentUrl);
                
                // ã‚³ãƒ”ãƒ¼æˆåŠŸæ™‚ã®è¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
                copyText.textContent = 'ã‚³ãƒ”ãƒ¼å®Œäº†ï¼';
                copyBtn.classList.add('bg-green-500', 'hover:bg-green-600');
                copyBtn.classList.remove('bg-kanjy-500', 'hover:bg-kanjy-600');
                
                // ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¤ã‚³ãƒ³ã«å¤‰æ›´
                copyIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>';
                
                // 2ç§’å¾Œã«å…ƒã«æˆ»ã™
                setTimeout(() => {
                    copyText.textContent = 'ã‚³ãƒ”ãƒ¼';
                    copyBtn.classList.remove('bg-green-500', 'hover:bg-green-600');
                    copyBtn.classList.add('bg-kanjy-500', 'hover:bg-kanjy-600');
                    copyIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>';
                }, 2000);
                
            } catch (err) {
                console.error('URLã®ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ:', err);
                // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: ãƒ†ã‚­ã‚¹ãƒˆã‚’é¸æŠçŠ¶æ…‹ã«ã™ã‚‹
                const urlElement = document.getElementById('eventUrl');
                const range = document.createRange();
                range.selectNode(urlElement);
                window.getSelection().removeAllRanges();
                window.getSelection().addRange(range);
                
                copyText.textContent = 'URLã‚’é¸æŠã—ã¾ã—ãŸ';
                setTimeout(() => {
                    copyText.textContent = 'ã‚³ãƒ”ãƒ¼';
                }, 2000);
            }
        }

        // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š
        function setupAnimations() {
            // æ”¹å–„ã•ã‚ŒãŸIntersection Observer for animations
            const observerOptions = {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            };
            
            const observer = new IntersectionObserver(function(entries) {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                        entry.target.classList.add('visible');
                    }
                });
            }, observerOptions);
            
            // Observe all animated elements
            document.querySelectorAll('.animate-slide-up, .animate-fade-in, .animate-scale-in, .fade-in-up').forEach(el => {
                if (!el.classList.contains('visible')) {
                    el.style.opacity = '0';
                    el.style.transform = 'translateY(20px)';
                    el.style.transition = 'opacity 0.6s cubic-bezier(0.4, 0, 0.2, 1), transform 0.6s cubic-bezier(0.4, 0, 0.2, 1)';
                }
                observer.observe(el);
            });
            
            // Add interactive hover effects
            document.querySelectorAll('.status-pill').forEach(pill => {
                pill.addEventListener('mouseenter', function() {
                    this.style.transform = 'scale(1.05)';
                });
                
                pill.addEventListener('mouseleave', function() {
                    this.style.transform = 'scale(1)';
                });
            });
            
            // Smooth scroll for better UX
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                });
            });
        }

    </script>
</body>
</html> 
